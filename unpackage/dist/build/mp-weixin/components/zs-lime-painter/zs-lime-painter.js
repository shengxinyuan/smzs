(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/zs-lime-painter/zs-lime-painter"],{"233c":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c},i=[]},"57d0":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n("a34a")),a=n("81681"),i=n("61bb"),s=n("f089"),u=n("72ad");function c(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n,r,a,i,s){try{var u=e[i](s),c=u.value}catch(o){return void n(o)}u.done?t(c):Promise.resolve(c).then(r,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){o(i,r,a,s,u,"next",e)}function u(e){o(i,r,a,s,u,"throw",e)}s(void 0)}))}}var l={name:"zs-lime-painter",props:{board:Object,pathType:{type:String},fileType:{type:String,default:"png"},quality:{type:Number,default:1},width:[Number,String],height:[Number,String],pixelRatio:Number,customStyle:String,isRenderImage:Boolean,isH5PathToBase64:Boolean,sleep:{type:Number,default:1e3/60},beforeDelay:{type:Number,default:1e3/60},afterDelay:Number,type:{type:String,default:"2d"}},data:function(){return{canvasId:"l-painter",use2dCanvas:!0,draw:null,ctx:null,canvasHeight:0,canvasWidth:0,layout:new s.Layout,isDrawIng:!1}},computed:{size:function(){return"width:".concat(this.boardWidth,"px; height: ").concat(this.boardHeight,"px;")},dpr:function(){return this.pixelRatio||e.getSystemInfoSync().pixelRatio},boardWidth:function(){var e=this.board||{},t=e.width;return(0,a.toPx)(this.width||t)},boardHeight:function(){var e=this.board||{},t=e.height,n=this.height,r=this.canvasHeight;return/^auto$/.test(n||t)?r||1:(0,a.toPx)(n||t)}},watch:{size:function(){this.use2dCanvas&&(this.inited=!1)}},created:function(){var e=wx.getSystemInfoSync(),t=e.SDKVersion,n=e.version,r=e.platform,i=e.environment;this.use2dCanvas="2d"===this.type&&(0,a.compareVersion)(t,"2.9.2")>=0&&!(/ios/i.test(r)&&/7.0.20/.test(n)||/wxwork/i.test(i)),console.log(this.use2dCanvas)},mounted:function(){var e=this;this.$watch("board",function(){var t=d(r.default.mark((function t(n,i){return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("{}"!==JSON.stringify(n)&&n){t.next=2;break}return t.abrupt("return");case 2:if(!e.beforeDelay){t.next=5;break}return t.next=5,(0,a.sleep)(e.beforeDelay);case 5:e.render();case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),{deep:!0,immediate:!0})},methods:{update:function(e,t){var n=this;return d(r.default.mark((function i(){return r.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.draw=null,n.use2dCanvas&&(n.ctx=null,n.inited=!1),n.isDrawIng=!1,r.next=5,new Promise((function(e){return n.$nextTick(e)}));case 5:return r.next=7,(0,a.sleep)(200);case 7:return r.abrupt("return",n.render(e,t));case 8:case"end":return r.stop()}}),i)})))()},render:function(){var e=arguments,t=this;return d(r.default.mark((function n(){var s,u,c,o,l,f,h,p,v,b,x,w,g,m;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=e.length>0&&void 0!==e[0]?e[0]:{},u=e.length>1&&void 0!==e[1]&&e[1],!t.isDrawIng){n.next=4;break}return n.abrupt("return",t.update(s,u));case 4:return t.isDrawIng=!0,c="{}"!=JSON.stringify(s),n.next=8,t.getContext();case 8:if(o=n.sent,l=t.use2dCanvas,f=t.boardWidth,h=t.boardHeight,p=t.board,v=t.canvas,b=t.isH5PathToBase64,x=t.sleep,w=t.afterDelay,!l||v){n.next=12;break}return n.abrupt("return",Promise.reject(new Error("render: fail canvas has not been created")));case 12:if(t.boundary={top:0,left:0,width:f,height:h},u||o.clearRect(0,0,f,h),t.draw&&!c||(t.draw=new i.Draw(o,v,l,b,x)),t.layout.init(o,t.boundary,b),!(c||p&&"{}"!=JSON.stringify(p))){n.next=20;break}return n.next=19,t.layout.calcNode(c?s:Object.assign({},p,{height:p.type||"auto"!=p.height?p.height:h}));case 19:t.node=n.sent;case 20:if(g=t.layout.layoutHeight,!/auto/.test(t.height||p.height)||t.canvasHeight){n.next=24;break}return t.canvasHeight=g,n.abrupt("return",t.update(s,u));case 24:if(!t.node){n.next=27;break}return n.next=27,null===(m=t.draw)||void 0===m?void 0:m.drawNode(t.node);case 27:return n.next=29,new Promise((function(e){return t.$nextTick(e)}));case 29:if(l||u){n.next=32;break}return n.next=32,t.canvasDraw(o);case 32:if(!w){n.next=35;break}return n.next=35,(0,a.sleep)(w);case 35:return t.$emit("done"),console.log(t.pathType),t.isRenderImage&&!u&&t.isDrawIng&&t.canvasToTempFilePath().then(function(){var e=d(r.default.mark((function e(n){var i,s;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(n),"base64"!=t.pathType){e.next=12;break}if(!/^data:image\/(\w+);base64/.test(n.tempFilePath)){e.next=6;break}t.$emit("success",n.tempFilePath),e.next=10;break;case 6:return e.next=8,(0,a.pathToBase64)(n.tempFilePath);case 8:i=e.sent,t.$emit("success",i);case 10:e.next=20;break;case 12:if("url"!=t.pathType){e.next=19;break}return e.next=15,(0,a.base64ToPath)(n.tempFilePath);case 15:s=e.sent,t.$emit("success",s),e.next=20;break;case 19:t.$emit("success",n.tempFilePath);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$emit("fail",new Error(JSON.stringify(e)))})),t.isDrawIng=!1,n.abrupt("return",Promise.resolve({ctx:o,draw:t.draw,node:t.node}));case 40:case"end":return n.stop()}}),n)})))()},custom:function(e){var t=this;return d(r.default.mark((function n(){var a,i,s;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.render({},!0);case 2:return a=n.sent,i=a.ctx,s=a.draw,i.save(),n.next=8,e(i,s);case 8:return i.restore(),n.abrupt("return",Promise.resolve(!0));case 10:case"end":return n.stop()}}),n)})))()},single:function(){var e=arguments,t=this;return d(r.default.mark((function n(){var a,i;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},n.next=3,t.render(a,!0);case 3:return i=n.sent,n.abrupt("return",Promise.resolve(i));case 5:case"end":return n.stop()}}),n)})))()},canvasDraw:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.ctx;return new Promise((function(n){t.draw(e,n)}))},getContext:function(){var t=this;return d(r.default.mark((function n(){var a,i,s,c,o,d;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.ctx||!t.inited){n.next=2;break}return n.abrupt("return",Promise.resolve(t.ctx));case 2:if(a=t.type,i=t.use2dCanvas,s=t.dpr,c=t.boardWidth,o=t.boardHeight,d=function(){return new Promise((function(n){e.createSelectorQuery().in(t).select("#".concat(t.canvasId)).boundingClientRect().exec((function(r){if(r){var a=e.createCanvasContext(t.canvasId,t);t.inited||(t.inited=!0,t.use2dCanvas=!1,t.canvas=r),t.ctx=(0,u.expand)(a),n(t.ctx)}}))}))},i){n.next=6;break}return n.abrupt("return",d());case 6:return n.abrupt("return",new Promise((function(n){e.createSelectorQuery().in(t).select("#".concat(t.canvasId)).node().exec((function(e){var r=e[0].node;r||(t.use2dCanvas=!1,n(t.getContext()));var i=r.getContext(a);t.inited||(t.inited=!0,r.width=c*s,r.height=o*s,t.use2dCanvas=!0,t.canvas=r,i.scale(s,s)),t.ctx=(0,u.adaptor)(i),n(t.ctx)}))})));case 7:case"end":return n.stop()}}),n)})))()},canvasToTempFilePath:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.use2dCanvas,a=this.canvasId,i=this.dpr;return new Promise((function(s,u){var c=t.boundary||t,o=c.top,d=void 0===o?0:o,l=c.left,f=void 0===l?0:l,h=c.width,p=c.height,v=h*i,b=p*i,x=n||t,w=x.fileType,g=x.quality,m={x:f,y:d,width:h,height:p,destWidth:v,destHeight:b,canvasId:a,fileType:w,quality:g,success:s,fail:u};r&&(delete m.canvasId,m.canvas=t.canvas),e.canvasToTempFilePath(m,t)}))}}};t.default=l}).call(this,n("543d")["default"])},"6e34":function(e,t,n){"use strict";n.r(t);var r=n("233c"),a=n("ae62");for(var i in a)"default"!==i&&function(e){n.d(t,e,(function(){return a[e]}))}(i);var s,u=n("f0c5"),c=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],s);t["default"]=c.exports},ae62:function(e,t,n){"use strict";n.r(t);var r=n("57d0"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,(function(){return r[e]}))}(i);t["default"]=a.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/zs-lime-painter/zs-lime-painter-create-component',
    {
        'components/zs-lime-painter/zs-lime-painter-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("6e34"))
        })
    },
    [['components/zs-lime-painter/zs-lime-painter-create-component']]
]);
