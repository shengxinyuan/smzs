(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-community-community~pages-index-mshare"],{"06c5":function(t,e,r){"use strict";r("a630"),r("fb6a"),r("d3b7"),r("25f0"),r("3ca3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=a(r("6b75"));function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(t){if("string"===typeof t)return(0,n.default)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.default)(t,e):void 0}}},"09f0":function(t,e,r){"use strict";function n(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(r.push(o.value),e&&r.length===e)break}catch(u){a=!0,i=u}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw i}}return r}}r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"0d21":function(t,e,r){"use strict";function n(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"1a43":function(t,e,r){"use strict";var n;r.d(e,"b",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.use2dCanvas?r("v-uni-canvas",{style:t.size+";"+t.customStyle,attrs:{id:t.canvasId,type:"2d"}}):r("v-uni-canvas",{style:t.size+";"+t.customStyle,attrs:{"canvas-id":t.canvasId,id:t.canvasId,width:t.boardWidth*t.dpr,height:t.boardHeight*t.dpr}})},i=[]},"37aa":function(t,e,r){"use strict";var n=r("4ea4");r("99af"),r("c975"),r("c19f"),r("ace4"),r("d3b7"),r("acd8"),r("e25e"),r("ac1f"),r("3ca3"),r("5319"),r("1276"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("2954"),r("649e"),r("219c"),r("b39a"),r("72f7"),r("ddb0"),r("2b3d"),Object.defineProperty(e,"__esModule",{value:!0}),e.sleep=s,e.isNumber=d,e.toPx=c,e.compareVersion=l,e.base64ToPath=h,e.pathToBase64=f,e.getImageInfo=v,r("96cf");var a=n(r("1da1")),i=n(r("3835")),o=/^(http|\/\/)/;function s(t){return new Promise((function(e){return setTimeout(e,t)}))}var u={};function d(t){return/^-?\d+(\.\d+)?$/.test(t)}function c(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"===typeof t)return t;if(d(t))return 1*t;if("string"===typeof t){var n=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|px|%)$/g,a=n.exec(t);if(!t||!a)return 0;var i=a[3];t=parseFloat(t);var o=0;return"rpx"===i?o=uni.upx2px(t):"px"===i?o=1*t:"%"===i?o=t*c(e)/100:"em"===i&&(o=t*c(e||14)),r?1*o.toFixed(2):Math.round(o)}}function l(t,e){t=t.split("."),e=e.split(".");var r=Math.max(t.length,e.length);while(t.length<r)t.push("0");while(e.length<r)e.push("0");for(var n=0;n<r;n++){var a=parseInt(t[n],10),i=parseInt(e[n],10);if(a>i)return 1;if(a<i)return-1}return 0}function h(t){var e=/data:image\/(\w+);base64,(.*)/.exec(t)||[],r=(0,i.default)(e,3);r[1],r[2];return new Promise((function(e,r){for(var n=t.split(",")[0].split(":")[1].split(";")[0],a=atob(t.split(",")[1]),i=new ArrayBuffer(a.length),o=new Uint8Array(i),s=0;s<a.length;s++)o[s]=a.charCodeAt(s);e(URL.createObjectURL(new Blob([o],{type:n})))}))}function f(t){return new Promise((function(e,r){var n=function(){var n=new Image;n.onload=function(){var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(n,0,0);var r=t.toDataURL("image/png");e(r),t.height=t.width=0},n.src=t,n.setAttribute("crossOrigin","Anonymous"),n.src=t,n.onerror=function(e){console.error("urlToBase64 error: ".concat(t),JSON.stringify(e)),r(new Error("urlToBase64 error"))}},a=function(t){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t),n.onerror=function(t){console.error("blobToBase64 error:",JSON.stringify(t)),r(new Error("blobToBase64 error"))}},i="function"===typeof FileReader;if(o.test(t)&&i){window.URL=window.URL||window.webkitURL;var s=new XMLHttpRequest;s.open("get",t,!0),s.timeout=2e3,s.responseType="blob",s.onload=function(){200==this.status?a(this.response):n()},s.onreadystatechange=function(){0===this.status&&console.error("图片跨域了，得后端处理咯")},s.send()}else/^blob/.test(t)&&i?a(t):n()}))}function v(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(){var n=(0,a.default)(regeneratorRuntime.mark((function n(a,i){var s,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(s=/^data:image\/(\w+);base64/,/^\.|^\/(?=[^\/])/,!o.test(t)||!e){n.next=6;break}return n.next=5,f(t);case 5:t=n.sent;case 6:if(!s.test(t)){n.next=16;break}if(u[t]){n.next=15;break}return d=t,n.next=11,h(t);case 11:t=n.sent,u[d]=t,n.next=16;break;case 15:t=u[t];case 16:u[t]&&u[t].errMsg&&!r?a(u[t]):uni.getImageInfo({src:t,success:function(e){e.path=e.path.replace(/^\./,window.location.origin),e.url=t,u[t]=e,a(u[t])},fail:function(e){a({path:t}),console.error("getImageInfo:fail ".concat(t," failed ").concat(JSON.stringify(e)))}});case 17:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())}},3835:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var n=s(r("0d21")),a=s(r("09f0")),i=s(r("06c5")),o=s(r("3d8c"));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return(0,n.default)(t)||(0,a.default)(t,e)||(0,i.default)(t,e)||(0,o.default)()}},"3d8c":function(t,e,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},4687:function(t,e,r){"use strict";r.r(e);var n=r("1a43"),a=r("5436");for(var i in a)"default"!==i&&function(t){r.d(e,t,(function(){return a[t]}))}(i);var o,s=r("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);e["default"]=u.exports},"4a88":function(t,e,r){"use strict";r("99af"),Object.defineProperty(e,"__esModule",{value:!0}),e.expand=a,e.adaptor=i;var n=function(t){return{setFonts:function(e){var r=e.fontFamily,n=void 0===r?"sans-serif":r,a=e.fontSize,i=void 0===a?14:a,o=e.fontWeight,s=void 0===o?"normal":o,u=e.textStyle,d=void 0===u?"normal":u;t.font="".concat(d," ").concat(s," ").concat(i,"px ").concat(n)}}};function a(t){return Object.assign(t,n(t))}function i(t){return Object.assign(t,n(t),{setStrokeStyle:function(e){t.strokeStyle=e},setLineWidth:function(e){t.lineWidth=e},setLineCap:function(e){t.lineCap=e},setFillStyle:function(e){t.fillStyle=e},setFontSize:function(e){t.font=String(e)},setGlobalAlpha:function(e){t.globalAlpha=e},setLineJoin:function(e){t.lineJoin=e},setTextAlign:function(e){t.textAlign=e},setMiterLimit:function(e){t.miterLimit=e},setShadow:function(e,r,n,a){t.shadowOffsetX=e,t.shadowOffsetY=r,t.shadowBlur=n,t.shadowColor=a},setTextBaseline:function(e){t.textBaseline=e},createCircularGradient:function(){},draw:function(){}})}},5436:function(t,e,r){"use strict";r.r(e);var n=r("5daf"),a=r.n(n);for(var i in n)"default"!==i&&function(t){r.d(e,t,(function(){return n[t]}))}(i);e["default"]=a.a},"5daf":function(t,e,r){"use strict";var n=r("4ea4");r("99af"),r("a9e3"),r("d3b7"),r("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r("96cf");var a=n(r("1da1")),i=r("37aa"),o=r("f7e9"),s=r("f171"),u=r("4a88"),d={name:"zs-lime-painter",props:{board:Object,pathType:{type:String},fileType:{type:String,default:"png"},quality:{type:Number,default:1},width:[Number,String],height:[Number,String],pixelRatio:Number,customStyle:String,isRenderImage:Boolean,isH5PathToBase64:Boolean,sleep:{type:Number,default:1e3/60},beforeDelay:{type:Number,default:1e3/60},afterDelay:Number},data:function(){return{canvasId:"l-painter".concat(this._uid),use2dCanvas:!1,draw:null,ctx:null,canvasHeight:0,canvasWidth:0,layout:new s.Layout,isDrawIng:!1}},computed:{size:function(){return"width:".concat(this.boardWidth,"px; height: ").concat(this.boardHeight,"px;")},dpr:function(){return this.pixelRatio||uni.getSystemInfoSync().pixelRatio},boardWidth:function(){var t=this.board||{},e=t.width;return(0,i.toPx)(this.width||e)},boardHeight:function(){var t=this.board||{},e=t.height,r=this.height,n=this.canvasHeight;return/^auto$/.test(r||e)?n||1:(0,i.toPx)(r||e)}},watch:{size:function(){}},mounted:function(){var t=this;this.$watch("board",function(){var e=(0,a.default)(regeneratorRuntime.mark((function e(r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("{}"!==JSON.stringify(r)&&r){e.next=2;break}return e.abrupt("return");case 2:if(!t.beforeDelay){e.next=5;break}return e.next=5,(0,i.sleep)(t.beforeDelay);case 5:t.render();case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),{deep:!0,immediate:!0})},methods:{update:function(t,e){var r=this;return(0,a.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.draw=null,r.isDrawIng=!1,n.next=4,new Promise((function(t){return r.$nextTick(t)}));case 4:return n.next=6,(0,i.sleep)(200);case 6:return n.abrupt("return",r.render(t,e));case 7:case"end":return n.stop()}}),n)})))()},render:function(){var t=arguments,e=this;return(0,a.default)(regeneratorRuntime.mark((function r(){var n,s,u,d,c,l,h,f,v,p,g,b,m,w;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:{},s=t.length>1&&void 0!==t[1]&&t[1],!e.isDrawIng){r.next=4;break}return r.abrupt("return",e.update(n,s));case 4:return e.isDrawIng=!0,u="{}"!=JSON.stringify(n),r.next=8,e.getContext();case 8:if(d=r.sent,c=e.use2dCanvas,l=e.boardWidth,h=e.boardHeight,f=e.board,v=e.canvas,p=e.isH5PathToBase64,g=e.sleep,b=e.afterDelay,!c||v){r.next=12;break}return r.abrupt("return",Promise.reject(new Error("render: fail canvas has not been created")));case 12:if(e.boundary={top:0,left:0,width:l,height:h},s||d.clearRect(0,0,l,h),e.draw&&!u||(e.draw=new o.Draw(d,v,c,p,g)),e.layout.init(d,e.boundary,p),!(u||f&&"{}"!=JSON.stringify(f))){r.next=20;break}return r.next=19,e.layout.calcNode(u?n:Object.assign({},f,{height:f.type||"auto"!=f.height?f.height:h}));case 19:e.node=r.sent;case 20:if(m=e.layout.layoutHeight,!/auto/.test(e.height||f.height)||e.canvasHeight){r.next=24;break}return e.canvasHeight=m,r.abrupt("return",e.update(n,s));case 24:if(!e.node){r.next=27;break}return r.next=27,null===(w=e.draw)||void 0===w?void 0:w.drawNode(e.node);case 27:return r.next=29,new Promise((function(t){return e.$nextTick(t)}));case 29:if(c||s){r.next=32;break}return r.next=32,e.canvasDraw(d);case 32:if(!b){r.next=35;break}return r.next=35,(0,i.sleep)(b);case 35:return e.$emit("done"),console.log(e.pathType),e.isRenderImage&&!s&&e.isDrawIng&&e.canvasToTempFilePath().then(function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(r),"base64"!=e.pathType){t.next=12;break}if(!/^data:image\/(\w+);base64/.test(r.tempFilePath)){t.next=6;break}e.$emit("success",r.tempFilePath),t.next=10;break;case 6:return t.next=8,(0,i.pathToBase64)(r.tempFilePath);case 8:n=t.sent,e.$emit("success",n);case 10:t.next=20;break;case 12:if("url"!=e.pathType){t.next=19;break}return t.next=15,(0,i.base64ToPath)(r.tempFilePath);case 15:a=t.sent,e.$emit("success",a),t.next=20;break;case 19:e.$emit("success",r.tempFilePath);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$emit("fail",new Error(JSON.stringify(t)))})),e.isDrawIng=!1,r.abrupt("return",Promise.resolve({ctx:d,draw:e.draw,node:e.node}));case 40:case"end":return r.stop()}}),r)})))()},custom:function(t){var e=this;return(0,a.default)(regeneratorRuntime.mark((function r(){var n,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.render({},!0);case 2:return n=r.sent,a=n.ctx,i=n.draw,a.save(),r.next=8,t(a,i);case 8:return a.restore(),r.abrupt("return",Promise.resolve(!0));case 10:case"end":return r.stop()}}),r)})))()},single:function(){var t=arguments,e=this;return(0,a.default)(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:{},r.next=3,e.render(n,!0);case 3:return a=r.sent,r.abrupt("return",Promise.resolve(a));case 5:case"end":return r.stop()}}),r)})))()},canvasDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.ctx;return new Promise((function(r){e.draw(t,r)}))},getContext:function(){var t=this;return(0,a.default)(regeneratorRuntime.mark((function e(){var r,n,a,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.ctx||!t.inited){e.next=2;break}return e.abrupt("return",Promise.resolve(t.ctx));case 2:return r=t.type,t.use2dCanvas,n=t.dpr,a=t.boardWidth,i=t.boardHeight,o=function(){return new Promise((function(e){uni.createSelectorQuery().in(t).select("#".concat(t.canvasId)).boundingClientRect().exec((function(r){if(r){var n=uni.createCanvasContext(t.canvasId,t);t.inited||(t.inited=!0,t.use2dCanvas=!1,t.canvas=r),t.ctx=(0,u.expand)(n),e(t.ctx)}}))}))},e.abrupt("return",o());case 7:return e.abrupt("return",new Promise((function(e){uni.createSelectorQuery().in(t).select("#".concat(t.canvasId)).node().exec((function(o){var s=o[0].node;s||(t.use2dCanvas=!1,e(t.getContext()));var d=s.getContext(r);t.inited||(t.inited=!0,s.width=a*n,s.height=i*n,t.use2dCanvas=!0,t.canvas=s,d.scale(n,n)),t.ctx=(0,u.adaptor)(d),e(t.ctx)}))})));case 8:case"end":return e.stop()}}),e)})))()},canvasToTempFilePath:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.use2dCanvas,n=this.canvasId,a=this.dpr;return new Promise((function(i,o){var s=t.boundary||t,u=s.top,d=void 0===u?0:u,c=s.left,l=void 0===c?0:c,h=s.width,f=s.height,v=h*a,p=f*a,g=e||t,b=g.fileType,m=g.quality,w={x:l,y:d,width:h,height:f,destWidth:v,destHeight:p,canvasId:n,fileType:b,quality:m,success:i,fail:o};r&&(delete w.canvasId,w.canvas=t.canvas),uni.canvasToTempFilePath(w,t)}))}}};e.default=d},"6b75":function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"944d":function(t,e,r){"use strict";var n=r("4ea4");r("c975"),r("baa5"),r("acd8"),r("ac1f"),r("466d"),r("1276"),r("2ca0"),r("498a"),Object.defineProperty(e,"__esModule",{value:!0}),e.GD=void 0;var a=n(r("b85c")),i={isGradient:function(t){return!(!t||!t.startsWith("linear")&&!t.startsWith("radial"))},doGradient:function(t,e,r,n){t.startsWith("linear")?d(e,r,t,n):t.startsWith("radial")&&s(e,r,t,n)}};function o(t){var e,r=t.substring(0,t.length-1).split("%,"),n=[],i=[],o=(0,a.default)(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;n.push(s.substring(0,s.lastIndexOf(" ")).trim()),i.push(s.substring(s.lastIndexOf(" "),s.length)/100)}}catch(u){o.e(u)}finally{o.f()}return{colors:n,percents:i}}function s(t,e,r,n){for(var a=o(r.match(/radial-gradient\((.+)\)/)[1]),i=n.createCircularGradient(0,0,t<e?e/2:t/2),s=0;s<a.colors.length;s++)i.addColorStop(a.percents[s],a.colors[s]);n.setFillStyle(i)}function u(t,e,r){var n,a=t.match(/([-]?\d{1,3})deg/),i=a&&a[1]?parseFloat(a[1]):0;switch(i){case 0:n=[0,-r/2,0,r/2];break;case 90:n=[e/2,0,-e/2,0];break;case-90:n=[-e/2,0,e/2,0];break;case 180:n=[0,r/2,0,-r/2];break;case-180:n=[0,-r/2,0,r/2];break;default:var o=0,s=0,u=0,d=0;a[1]>0&&a[1]<90?(o=e/2-(e/2*Math.tan((90-a[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-a[1])*Math.PI*2/360)/2,d=Math.tan((90-a[1])*Math.PI*2/360)*o,u=-o,s=-d):a[1]>-180&&a[1]<-90?(o=-e/2+(e/2*Math.tan((90-a[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-a[1])*Math.PI*2/360)/2,d=Math.tan((90-a[1])*Math.PI*2/360)*o,u=-o,s=-d):a[1]>90&&a[1]<180?(o=e/2+(-e/2*Math.tan((90-a[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-a[1])*Math.PI*2/360)/2,d=Math.tan((90-a[1])*Math.PI*2/360)*o,u=-o,s=-d):(o=-e/2-(-e/2*Math.tan((90-a[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-a[1])*Math.PI*2/360)/2,d=Math.tan((90-a[1])*Math.PI*2/360)*o,u=-o,s=-d),n=[o,s,u,d];break}return n}function d(t,e,r,n){for(var a=u(r,t,e),i=n.createLinearGradient(a[0],a[1],a[2],a[3]),s=r.match(/linear-gradient\((.+)\)/)[1],d=o(s.substring(s.indexOf(",")+1)),c=0;c<d.colors.length;c++)i.addColorStop(d.percents[c],d.colors[c]);n.setFillStyle(i)}e.GD=i},b85c:function(t,e,r){"use strict";r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var n=a(r("06c5"));function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=(0,n.default)(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r["return"]||r["return"]()}finally{if(u)throw o}}}}},baa5:function(t,e,r){var n=r("23e7"),a=r("e58c");n({target:"Array",proto:!0,forced:a!==[].lastIndexOf},{lastIndexOf:a})},cb29:function(t,e,r){var n=r("23e7"),a=r("81d5"),i=r("44d2");n({target:"Array",proto:!0},{fill:a}),i("fill")},f171:function(t,e,r){"use strict";var n=r("4ea4");r("4160"),r("caad"),r("d81d"),r("b64b"),r("ac1f"),r("2532"),r("466d"),r("5319"),r("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.Layout=void 0;var a=n(r("3835")),i=n(r("ade3"));r("96cf");var o=n(r("1da1")),s=n(r("d4ec")),u=n(r("bee2")),d=r("37aa"),c=function(){function t(){(0,s.default)(this,t),this.layoutHeight=0,this.layoutWidth=0,this.uuid=0}return(0,u.default)(t,[{key:"init",value:function(t,e,r){this.ctx=t,this.root=e,this.layoutWidth=e.width||0,this.layoutHeight=e.height||0,this.uuid=0,this.isH5PathToBase64=r}},{key:"getNodeTree",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var r,n,a,i,o,s,u,d,c,l,h,f,v,p,g,b,m,w,x=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=x.length>1&&void 0!==x[1]?x[1]:{},n=x.length>2&&void 0!==x[2]?x[2]:0,a=x.length>3&&void 0!==x[3]?x[3]:[],i=x.length>4?x[4]:void 0,o=Object.assign({},this.getComputedStyle(e,r,n)),t.next=7,this.getAttributes(e);case 7:if(s=t.sent,u={id:this.uuid++,parent:r,computedStyle:o,rules:e.rules,attributes:Object.assign({},s),name:(null===e||void 0===e?void 0:e.type)||"view",isRoot:!(null===e||void 0===e?void 0:e.type)&&"{}"==JSON.stringify(r)},"{}"!==JSON.stringify(r)||e.type?u.layoutBox=Object.assign({left:0,top:0},this.getLayoutBox(u,r,n,a,i)):(d=o.left,c=void 0===d?0:d,l=o.top,h=void 0===l?0:l,f=o.width,v=void 0===f?0:f,p=o.height,g=void 0===p?0:p,u.layoutBox={left:c,top:h,width:v,height:g}),!(null===e||void 0===e?void 0:e.views)){t.next=25;break}b=[],u.children=[],m=0;case 14:if(!(m<e.views.length)){t.next=24;break}return w=e.views[m],t.t0=b,t.next=19,this.getNodeTree(w,u,m,b,e);case 19:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 21:m++,t.next=14;break;case 24:u.children=b;case 25:return t.abrupt("return",u);case 26:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getComputedStyle",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},o=t.name||t.type,s="{}"!=JSON.stringify(r)||o?t.css:t;if(!s)return n;var u=["color","fontSize","lineHeight","verticalAlign","fontWeight","textAlign"];r.computedStyle&&u.forEach((function(t){(s[t]||r.computedStyle[t])&&(s[t]=s[t]||r.computedStyle[t])}));for(var c=function(){var t=h[l],u=s[t];if("views"==t)return"continue";if(/^(box)?shadow$/i.test(t)){var c=u.split(" ").map((function(t){return/^\d/.test(t)?(0,d.toPx)(t):t}));return n.boxShadow=c,"continue"}if(/^border/i.test(t)&&!/radius$/i.test(t)){var f,v=t.match(/^border([BTRLa-z]+)?/)[0],p=t.match(/[W|S|C][a-z]+/),g=u.replace(/([\(,])\s+|\s+([\),])/g,"$1$2").split(" ").map((function(t){return/^\d/.test(t)?(0,d.toPx)(t,"",!0):t}));return n[v]=(f={},(0,i.default)(f,v+"Width",((0,d.isNumber)(g[0])?g[0]:0)||1),(0,i.default)(f,v+"Style",g[1]||"solid"),(0,i.default)(f,v+"Color",g[2]||"black"),f),1==g.length&&p&&(n[v][v+p[0]]=g[0]),"continue"}if(/^background(color)?$/i.test(t))return n["backgroundColor"]=u,"continue";if(/padding|margin|radius/i.test(t)){var b=/radius$/i.test(t),m=b?"borderRadius":t.match(/[a-z]+/)[0],w=[0,0,0,0].map((function(t,e){return b?["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"][e]:[m+"Top",m+"Right",m+"Bottom",m+"Left"][e]}));if("padding"===t||"margin"===t||/^(border)?radius$/i.test(t)){var x,y=(null===u||void 0===u?void 0:u.split(" ").map((function(t){return/^\d/.test(t)&&(0,d.toPx)(t,s["width"])}),[]))||[0],k=b?"borderRadius":t,P=(0,a.default)(y,4),T=P[0],S=P[1],R=P[2],I=P[3];n[k]=(x={},(0,i.default)(x,w[0],T),(0,i.default)(x,w[1],(0,d.isNumber)(S)?S:T),(0,i.default)(x,w[2],(0,d.isNumber)(R)?R:T),(0,i.default)(x,w[3],(0,d.isNumber)(I)?I:S||T),x)}else{var M;if("object"===typeof n[m])n[m][t]=(0,d.toPx)(u,s["width"]);else n[m]=(M={},(0,i.default)(M,w[0],n[m]||0),(0,i.default)(M,w[1],n[m]||0),(0,i.default)(M,w[2],n[m]||0),(0,i.default)(M,w[3],n[m]||0),M),n[m][t]=(0,d.toPx)(u,s["width"])}return"continue"}if(/^(width|height)$/i.test(t))return/%$/.test(u)?n[t]=(0,d.toPx)(u,r.layoutBox[t]):n[t]=/px|rpx$/.test(u)?(0,d.toPx)(u):u,"continue";if(/^transform$/i.test(t))return n[t]={},u.replace(/([a-zA-Z]+)\(([0-9,-\.%rpxdeg\s]+)\)/g,(function(e,r,a){var i=a.split(",").map((function(t){return t.replace(/(^\s*)|(\s*$)/g,"")})),o=function(t,e){return t.includes("deg")?1*t:e&&!/%$/.test(e)?(0,d.toPx)(t,e):t};r.includes("matrix")?n[t][r]=i.map((function(t){return 1*t})):r.includes("rotate")?n[t][r]=1*a.match(/^-?\d+(\.\d+)?/)[0]:/[X, Y]/.test(r)?n[t][r]=/[X]/.test(r)?o(i[0],s["width"]):o(i[0],s["height"]):(n[t][r+"X"]=o(i[0],s["width"]),n[t][r+"Y"]=o(i[1]||i[0],s["height"]))})),"continue";if(/^transformOrigin/i.test(t))return n[t]=u,"continue";if(/%/.test(u)){var O=r.layoutBox,B=O.width,L=O.height,j=(O.left,O.top,e.root),N=j.width,C=j.height;n.position;n[t]="width"==t?(0,d.toPx)(u,B||N):"height"==t?(0,d.toPx)(u,L||C):"left"==t||"top"==t?u:(0,d.toPx)(u,s["width"])}else n[t]=/px|rpx$/.test(u)?(0,d.toPx)(u):/em$/.test(u)&&"text"==o?(0,d.toPx)(u,s["fontSize"]):u},l=0,h=Object.keys(s);l<h.length;l++)c();return/image/.test(t.name||t.type)&&!n.mode&&(n.mode=t.mode||"scaleToFill",s.width&&"auto"!=s.width||s.height&&"auto"!=s.width||(n.mode="")),n}},{key:"getLayoutBox",value:function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o={},s=t||{},u=s.name,c=s.computedStyle,l=(s.layoutBox,s.attributes);s.isRoot;if(!u)return o;var h=this.ctx,f=n.layoutBox,v=void 0===f?this.root:f,p=n.computedStyle,g=c.verticalAlign,b=c.left,m=c.top,w=c.width,x=c.height,y=c.fontSize,k=void 0===y?14:y,P=c.lineHeight,T=void 0===P?"1.4em":P,S=c.maxLines,R=c.fontWeight,I=c.fontFamily,M=c.textStyle,O=c.position,B=c.display,L=c.padding,j=void 0===L?{}:L,N=c.margin,C=void 0===N?{}:N,_=j.paddingTop,F=void 0===_?0:_,W=j.paddingRight,$=void 0===W?0:W,A=j.paddingBottom,H=void 0===A?0:A,D=j.paddingLeft,z=void 0===D?0:D,J=C.marginTop,G=void 0===J?0:J,E=C.marginRight,U=void 0===E?0:E,X=C.marginBottom,q=void 0===X?0:X,Y=C.marginLeft,V=void 0===Y?0:Y,Q=i[a-1]||{},Z=Q.layoutBox,K=Q.computedStyle,tt=Q.name,et=i[a+1]||{},rt=et.layoutBox,nt=(et.computedStyle,et.name,(null===K||void 0===K||null===(e=K.margin)||void 0===e?void 0:e.marginBottom)||0),at=(null===K||void 0===K||null===(r=K.margin)||void 0===r?void 0:r.marginRight)||0;if(/%$/.test(b)&&(b=(0,d.toPx)(b,v.width)),/%$/.test(m)&&(m=(0,d.toPx)(m,v.height)),"relative"==O&&(b+=v.left,m+=v.top),"text"===u){var it=l.text||"";T=(0,d.toPx)(T,k),h.save(),h.setFonts({fontFamily:I,fontSize:k,fontWeight:R,textStyle:M});var ot=0==a,st="inlineBlock"===B,ut="block"===B||"block"===(null===K||void 0===K?void 0:K.display),dt=ot&&!rt||!(null===n||void 0===n?void 0:n.id),ct=ot||ut?0:Z.offsetRight||0,lt=it.split("\n"),ht=1,ft="",vt=c.textIndent||0;dt||st?(ft=it,ht=Math.max(lt.length,Math.ceil(h.measureText(it,k).width/((w||v.width)-h.measureText("!",k).width/2)))):lt.map((function(t,e){ht+=e;for(var r=t.split(""),n=0;n<r.length;n++){var a=r[n],i=ft+a,o=h.measureText(i,k).width;1==ht&&(o=o+(ut?0:ct)+vt),o>(w||v.width)?(ht++,ft=a):ft=i}})),st||(o.offsetLeft=((0,d.isNumber)(b)||ut||dt?vt:ct)+z+V),o.offsetTop=F;var pt=h.measureText(ft,k).width,gt=(ht>1?v.width:pt+((null===o||void 0===o?void 0:o.offsetLeft)||0))+$;st||(o.offsetRight=(b||0)+o.offsetLeft+(w||(ut?v.width:pt))+$+U);var bt=Z?Z.left+Z.width:0,mt=function(){return st?(bt+gt>v.width||ot?v.left:bt+at)+V:b||v.left},wt=function(){return st?gt+z+$:w||(!dt||ut?v.width:gt>v.width-o.left||ht>1?v.width-o.left:gt)},xt=function(){return x||(ht>1?(S||ht)*T+F+H:T+F+H)},yt=function(){var t=m;return t||(t=ot?v.top:1==ht&&gt<v.width&&"text"===tt&&!ut&&!st||Z.width<v.width&&!(st&&bt+gt>v.width)?Z.top:Z.top+Z.height-((null===n||void 0===n?void 0:n.id)&&((null===K||void 0===K?void 0:K.lineHeight)||0))),"bottom"===g&&(t=v.top+(v.height-o.height||0)),"middle"===g&&(t=v.top+(v.height?(v.height-o.height||0)/2:0)),t+G+(ut&&(null===K||void 0===K?void 0:K.lineHeight)||0)+(bt+gt>v.width?nt:0)};o.left=mt(),o.width=wt(),o.height=xt(),o.top=yt(),p&&!p.height&&(v.height=o.top-v.top+o.height),h.restore()}else if(["view","qrcode"].includes(u))o.left=(b||v.left)+V-U,o.width=(w||(null===v||void 0===v?void 0:v.width))-z-$,o.height=x||0,(0,d.isNumber)(m)?o.top=m+G:o.top=(Z&&Z.top+Z.height||v.top)+G+nt;else if("image"===u){var kt=l.width,Pt=l.height,Tt=Z&&Z.left+Z.width;if((0,d.isNumber)(b)?o.left=b+V-U:o.left=(Z&&(Tt<v.width?Tt:v.left)||v.left)+V-U,(0,d.isNumber)(w)?o.width=w:o.width=Math.round((0,d.isNumber)(x)?kt*x/Pt:null===v||void 0===v?void 0:v.width),(0,d.isNumber)(x))o.height=x;else{var St=Math.round(o.width*Pt/kt);o.height=Math.min(St,null===v||void 0===v?void 0:v.height)}(0,d.isNumber)(m)?o.top=m+G:o.top=(Z&&(Tt<v.width?Tt:Z.top+Z.height)||v.top)+G+nt}return o.top+o.height+q>this.layoutHeight&&(this.layoutHeight=o.top+o.height+q),o}},{key:"getAttributes",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var r,n,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={},!(null===e||void 0===e?void 0:e.url)&&!(null===e||void 0===e?void 0:e.src)){t.next=16;break}return r.src=e.url||(null===e||void 0===e?void 0:e.src),t.next=5,(0,d.getImageInfo)(r.src,this.isH5PathToBase64);case 5:if(t.t0=t.sent,t.t0){t.next=8;break}t.t0={};case 8:n=t.t0,a=n.width,i=void 0===a?0:a,o=n.height,s=void 0===o?0:o,u=n.path,c=n.url,r=Object.assign({},r,{width:i,height:s,src:u,url:c});case 16:return(null===e||void 0===e?void 0:e.text)&&(r.text=e.text),t.abrupt("return",r);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"calcNode",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getNodeTree(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();e.Layout=c},f7e9:function(t,e,r){"use strict";var n=r("4ea4");r("cb29"),r("4de4"),r("caad"),r("c975"),r("d81d"),r("13d5"),r("b64b"),r("d3b7"),r("07ac"),r("ac1f"),r("2532"),r("5319"),r("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.Draw=void 0;var a=n(r("b85c"));r("96cf");var i=n(r("1da1")),o=n(r("ade3")),s=n(r("3835")),u=n(r("d4ec")),d=n(r("bee2")),c=r("37aa"),l=r("944d"),h=n(r("fd57")),f=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;(0,u.default)(this,t),this.ctx=e,this.canvas=r||null,this.use2dCanvas=n,this.isH5PathToBase64=a,this.sleep=i}return(0,d.default)(t,[{key:"roundRect",value:function(t,e,r,n,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!(a<0)){var s=this.ctx;if(s.beginPath(),a){var u=a||{},d=u.borderTopLeftRadius,c=void 0===d?a||0:d,l=u.borderTopRightRadius,h=void 0===l?a||0:l,f=u.borderBottomRightRadius,v=void 0===f?a||0:f,p=u.borderBottomLeftRadius,g=void 0===p?a||0:p;s.arc(t+r-v,e+n-v,v,0,.5*Math.PI),s.lineTo(t+g,e+n),s.arc(t+g,e+n-g,g,.5*Math.PI,Math.PI),s.lineTo(t,e+c),s.arc(t+c,e+c,c,Math.PI,1.5*Math.PI),s.lineTo(t+r-h,e),s.arc(t+r-h,e+h,h,1.5*Math.PI,2*Math.PI),s.lineTo(t+r,e+n-v)}else s.rect(t,e,r,n);s.closePath(),o&&s.stroke(),i&&s.fill()}}},{key:"setTransform",value:function(t,e){var r=e.transform,n=e.transformOrigin,a=void 0===n?"center center":n,i=this.ctx,o=r||{},s=o.scaleX,u=void 0===s?1:s,d=o.scaleY,l=void 0===d?1:d,h=o.translateX,f=void 0===h?0:h,v=o.translateY,p=void 0===v?0:v,g=o.rotate,b=void 0===g?0:g,m=o.skewX,w=void 0===m?0:m,x=o.skewY,y=void 0===x?0:x,k=t.left,P=t.top,T=t.width,S=t.height;f=(0,c.toPx)(f,T)||0,p=(0,c.toPx)(p,S)||0;var R={top:(0,c.toPx)("0%",1),center:(0,c.toPx)("50%",1,!0),bottom:(0,c.toPx)("100%",1)},I={left:(0,c.toPx)("0%",1),center:(0,c.toPx)("50%",1,!0),right:(0,c.toPx)("100%",1)};a=a.split(" ").filter((function(t,e){return e<2})).reduce((function(t,e){if(/\d+/.test(e)){var r=(0,c.toPx)(e,1,!0)/(/px|rpx$/.test(e)?(0,c.isNumber)(t.x)?S:T:1);return(0,c.isNumber)(t.x)?Object.assign(t,{y:r}):Object.assign(t,{x:r})}return(0,c.isNumber)(I[e])&&!(0,c.isNumber)(t.x)?Object.assign(t,{x:I[e]}):Object.assign(t,{y:R[e]})}),{}),i.scale(u,l);var M={x:T*(u>0?1:-1)*a.x+(k+f)/u,y:S*(l>0?1:-1)*a.y+(P+p)/l};return i.translate(M.x,M.y),b&&i.rotate(b*Math.PI/180),(w||y)&&i.transform(1,Math.tan(y*Math.PI/180),Math.tan(w*Math.PI/180),1,0,0),{x:-T*a.x,y:-S*a.y,w:T,h:S}}},{key:"setBackground",value:function(t,e,r){var n=this.ctx;t?l.GD.isGradient(t)?l.GD.doGradient(t,e,r,n):n.setFillStyle(t):n.setFillStyle("transparent")}},{key:"setShadow",value:function(t){var e=t.boxShadow,r=void 0===e?[]:e,n=this.ctx;if(r.length){var a=(0,s.default)(r,4),i=a[0],o=a[1],u=a[2],d=a[3];n.setShadow(i,o,u,d)}}},{key:"setBorder",value:function(t,e){var r,n=this.ctx,a=t.width,i=t.height,s=e.border,u=e.borderBottom,d=e.borderTop,c=e.borderRight,l=e.borderLeft,h=e.borderRadius,f=s||{},v=f.borderWidth,p=void 0===v?0:v,g=f.borderStyle,b=f.borderColor,m=u||{},w=m.borderBottomWidth,x=void 0===w?p:w,y=m.borderBottomStyle,k=void 0===y?g:y,P=m.borderBottomColor,T=void 0===P?b:P,S=d||{},R=S.borderTopWidth,I=void 0===R?p:R,M=S.borderTopStyle,O=void 0===M?g:M,B=S.borderTopColor,L=void 0===B?b:B,j=c||{},N=(j.borderRightWidth,j.borderRightStyle,j.borderRightColor,l||{}),C=N.borderLeftWidth,_=void 0===C?p:C,F=N.borderLeftStyle,W=void 0===F?g:F,$=N.borderLeftColor,A=void 0===$?b:$,H=h||(r={r:h},(0,o.default)(r,"r",h),(0,o.default)(r,"r",h),(0,o.default)(r,"r",h),r),D=H.borderTopLeftRadius,z=void 0===D?h||0:D,J=H.borderTopRightRadius,G=void 0===J?h||0:J,E=H.borderBottomRightRadius,U=void 0===E?h||0:E,X=H.borderBottomLeftRadius,q=void 0===X?h||0:X;if(u||l||d||c||s){var Y=function(t,e,r){"dashed"==e?n.setLineDash([Math.ceil(6*t),Math.ceil(6*t)]):"dotted"==e&&n.setLineDash([t,t]),n.setStrokeStyle(r)},V=function(t,e,r,a,i,o,s,u,d,c,l,h,f,v){n.save(),n.setLineWidth(h),Y(h,f,v),n.beginPath(),n.arc(t,e,s,Math.PI*d,Math.PI*c),n.lineTo(r,a),n.arc(i,o,u,Math.PI*c,Math.PI*l),n.stroke(),n.restore()};n.save(),this.setOpacity(e);var Q=this.setTransform(t,e),Z=Q.x,K=Q.y;s&&(n.setLineWidth(p),Y(p,g,b),this.roundRect(Z,K,a,i,h,!1,!!b),n.restore()),u&&V(Z+a-U,K+i-U,Z+q,K+i,Z+q,K+i-q,U,q,.25,.5,.75,x,k,T),l&&V(Z+q,K+i-q,Z,K+z,Z+z,K+z,q,z,.75,1,1.25,_,W,A),d&&V(Z+z,K+z,Z+a-G,K,Z+a-G,K+G,z,G,1.25,1.5,1.75,I,O,L),c&&V(Z+a-G,K+G,Z+a,K+i-U,Z+a-U,K+i-U,G,U,1.75,2,.25,I,O,L)}}},{key:"setOpacity",value:function(t){var e=t.opacity,r=void 0===e?1:e;this.ctx.setGlobalAlpha(r)}},{key:"drawView",value:function(t,e){var r=this.ctx,n=t.width,a=t.height,i=e||{},o=i.borderRadius,s=void 0===o?0:o,u=i.backgroundColor;r.save(),this.setOpacity(e);var d=this.setTransform(t,e),c=d.x,l=d.y;this.setShadow(e),this.setBackground(u,n,a),this.roundRect(c,l,n,a,s,!0,!1),r.restore(),this.setBorder(t,e)}},{key:"drawImage",value:function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(e){var r,n,a,o=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2&&void 0!==s[2]?s[2]:{},a=!(s.length>3&&void 0!==s[3])||s[3],t.next=5,new Promise(function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(s,u){var d,l,h,f,v,p,g,b,m,w,x,y,k,P,T,S,R,I,M,O,B,L,j,N,C,_,F,W,$,A,H;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(d=o.ctx,l=o.sleep,h=o.canvas,f=n.borderRadius,v=void 0===f?0:f,p=n.mode,g=n.padding,b=void 0===g?{}:g,m=n.backgroundColor,w=b.paddingTop,x=void 0===w?0:w,y=b.paddingLeft,k=void 0===y?0:y,P=b.paddingRight,T=void 0===P?0:P,S=b.paddingBottom,R=void 0===S?0:S,I=r.left,M=r.top,O=r.width,B=r.height,d.save(),a||(o.setOpacity(n),L=o.setTransform(r,n),j=L.x,N=L.y,m&&o.setBackground(m,O,B),I=j,M=N,o.setShadow(n),o.roundRect(I,M,O,B,v,!!v,!1)),d.clip(),C=function(t){I+=k,M+=x,O=O-k-T,B=B-x-R;var e=t.width,r=t.height,n=t.src,a=0,i=0,o=O/B,s=e/r;switch(e||(p="scaleToFill"),p){case"aspectFit":o>=s?(e=B*s,r=B,a=I+Math.round(O-e)/2,i=M):(e=O,r=O/s,a=I,i=M+Math.round(B-r)/2),d.drawImage(n,a,i,e,r);break;case"aspectFill":o>=s?r=e/o:(e=r*o,a=Math.round(((t.width||O)-e)/2)),d.drawImage(n,a,i,e,r,I,M,O,B);break;default:d.drawImage(n,I,M,O,B)}},_=function(){d.restore(),o.setBorder(r,n),setTimeout(s,l)},F=function t(e){if(o.use2dCanvas){var r=h.createImage();r.onload=function(){e.src=r,C(e),_()},r.onerror=(0,i.default)(regeneratorRuntime.mark((function r(){var n,a,i,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.url){r.next=10;break}return r.next=3,(0,c.getImageInfo)(e.url,o.isH5PathToBase64,!0);case 3:n=r.sent,a=n.path,i=n.width,u=n.height,t({src:a,width:i,height:u}),r.next=12;break;case 10:console.error("createImage fail: ".concat(JSON.stringify(e))),s(!0);case 12:case"end":return r.stop()}}),r)}))),r.src=e.src}else C(e),_()},"string"!==typeof e){t.next=21;break}return t.next=14,(0,c.getImageInfo)(e,o.isH5PathToBase64);case 14:W=t.sent,$=W.path,A=W.width,H=W.height,F({src:$,width:A,height:H}),t.next=22;break;case 21:F(e);case 22:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"drawText",value:function(t,e,r,n){var a=this.ctx,i=e.width,o=e.height,s=e.offsetLeft,u=void 0===s?0:s,d=e.offsetTop,l=void 0===d?0:d,h=r.color,f=void 0===h?"#000000":h,v=r.lineHeight,p=void 0===v?"1.4em":v,g=r.fontSize,b=void 0===g?14:g,m=r.fontWeight,w=r.fontFamily,x=r.textStyle,y=r.textAlign,k=void 0===y?"left":y,P=r.verticalAlign,T=void 0===P?"top":P,S=r.backgroundColor,R=r.maxLines,I=(r.display,r.padding,r.borderRadius),M=void 0===I?0:I,O=r.textDecoration;if(p=(0,c.toPx)(p,b),t){a.save(),this.setOpacity(r);var B=this.setTransform(e,r),L=B.x,j=B.y;a.setTextBaseline(T),a.setFonts({fontFamily:w,fontSize:b,fontWeight:m,textStyle:x}),a.setTextAlign(k),S&&(this.setBackground(S,i,o),this.roundRect(L,j,i,o,M,1,0)),j+=l,this.setShadow(r),a.setFillStyle(f);var N={};if(n&&n.word.length>0)for(var C=0;C<n.word.length;C++){var _=0,F=void 0;while((F=t.indexOf(n.word[C],_))>-1){N[F]={reset:!0};for(var W=0;W<n.word[C].length;W++)N[F+W]={reset:!0};_=F+1}}switch(k){case"left":break;case"center":L+=.5*i;break;case"right":L+=i;break;default:break}var $=a.measureText(t).width,A=Math.ceil($/i)*p,H=Math.ceil((o-A)/2);switch(H<0&&(H=0),T){case"top":break;case"middle":j+=b/2;break;case"bottom":j+=b;break;default:break}var D=function(t,e,r){var n=uni.getSystemInfoSync(),i=n.system;switch(/win|mac/.test(i)&&(e+=b/3),T){case"top":break;case"middle":e-=b/2;break;case"bottom":e-=b;break;default:break}var o=t;switch(k){case"left":t=t,o+=r;break;case"center":t-=r/2,o=t+r;break;case"right":o=t,t-=r;break;default:break}O&&(a.setLineWidth(b/13),a.beginPath(),/\bunderline\b/.test(O)&&(e-=.8*U,a.moveTo(t,e),a.lineTo(o,e)),/\boverline\b/.test(O)&&(e+=U,a.moveTo(t,e-p),a.lineTo(o,e-p)),/\bline-through\b/.test(O)&&(a.moveTo(t,e-p/2),a.lineTo(o,e-p/2)),a.closePath(),a.setStrokeStyle(f),a.stroke())},z=function(t,e,r){for(var i=Object.keys(N),o=0;o<i.length;o++){var s=N[i[o]];a.save(),a.setFillStyle(n.color),s.char&&a.fillText(s.char,s.x,s.y),a.restore()}},J=function(t,e){if(t){var r=Math.round(a.measureText(" ").width),n=Math.round(a.measureText("　").width),i=Math.round(a.measureText(e).width),o="",s=1;return i==n?(o="　",s=1):(o=" ",s=Math.ceil(i/r)),{char:new Array(s).fill(o).join(""),width:i}}return{char:e}},G=function(t,e,r,n){N[e].x=r,N[e].y=n,N[e].char=t},E=function(t,e,r,n,i){var o=i.startIndex,s=void 0===o?0:o,u=(i.endIndex,r);/·/.test(r)&&(u=u.replace(/·/g,"."),n=a.measureText(u).width);for(var d=r.split(""),c=t,l=0;l<e.length;l++){var h=e[l],f=h-s,v=d[f];if(v){var p=J(N[h],v),g=p.char,b=p.width;d[f]=g,"center"==k&&(c=t-.5*(n-b)),"right"==k&&(c=t-n+b),G(v,h,c+a.measureText(u.substring(0,f)).width,j+U)}}return d},U=Math.ceil((p-b)/2);if($+u<=i&&!t.includes("\n")){L+=u;var X=Object.keys(N),q="";return X&&(q=E(L,X,t,$,{}),z()),a.fillText(q.join(""),L,j+U),j+=p,D(L,j,$),a.restore(),void this.setBorder(e,r)}for(var Y=t.split(""),V=j,Q=L,Z="",K=0,tt=0,et=0;et<=Y.length;et++){var rt=Y[et]||"",nt="\n"===rt,at=""==rt;rt=nt?"":rt;var it=Z+rt,ot=a.measureText(it).width;if(K>=R)break;if(0==K?(ot+=u,Q=L+u):(ot=ot,Q=L),ot>i||nt||at){var st=et;if(K++,Z=at&&ot<=i?it:Z,K===R&&ot>i){while(a.measureText("".concat(Z,"...")).width>i){if(Z.length<=1)break;Z=Z.substring(0,Z.length-1)}Z+="..."}var ut=Object.keys(N),dt="";if(ut&&(dt=E(L,ut,Z,ot,{startIndex:tt,endIndex:st}),z()),a.fillText(dt.join(""),Q,j+U),j+=p,D(Q,j,ot),Z=rt,tt=st+(nt?1:0),j+p>V+o)break}else Z=it}a.restore(),this.setBorder(e,r)}}},{key:"drawNode",value:function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(e){var r,n,i,o,s,u,d,c,l,f,v,p,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.layoutBox,n=e.computedStyle,i=e.attributes,o=e.name,s=e.rules,u=e.children,d=e.attributes,c=d.src,l=d.text,"view"!==o){t.next=6;break}this.drawView(r,n),t.next=12;break;case 6:if("image"!==o||!c){t.next=11;break}return t.next=9,this.drawImage(i,r,n,!1);case 9:t.next=12;break;case 11:"text"===o?this.drawText(l,r,n,s):"qrcode"===o&&(null===h.default||void 0===h.default?void 0:h.default.api)&&h.default.api.draw(l,this,r,n);case 12:if(u){t.next=14;break}return t.abrupt("return");case 14:f=Object.values?Object.values(u):Object.keys(u).map((function(t){return u[t]})),v=(0,a.default)(f),t.prev=16,v.s();case 18:if((p=v.n()).done){t.next=24;break}return g=p.value,t.next=22,this.drawNode(g);case 22:t.next=18;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](16),v.e(t.t0);case 29:return t.prev=29,v.f(),t.finish(29);case 32:case"end":return t.stop()}}),t,this,[[16,26,29,32]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();e.Draw=f},fd57:function(t,e){}}]);