(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-community-community~pages-index-mshare"],{"06c5":function(t,e,r){"use strict";r("a630"),r("fb6a"),r("d3b7"),r("25f0"),r("3ca3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var n=i(r("6b75"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(t){if("string"===typeof t)return(0,n.default)(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.default)(t,e):void 0}}},"0727":function(t,e,r){"use strict";r.r(e);var n=r("e3e3"),i=r.n(n);for(var a in n)"default"!==a&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},"09f0":function(t,e,r){"use strict";function n(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(r.push(o.value),e&&r.length===e)break}catch(u){i=!0,a=u}finally{try{n||null==s["return"]||s["return"]()}finally{if(i)throw a}}return r}}r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"0d21":function(t,e,r){"use strict";function n(t){if(Array.isArray(t))return t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"21d5":function(t,e,r){"use strict";var n=r("4ea4");r("c975"),r("baa5"),r("acd8"),r("ac1f"),r("466d"),r("1276"),r("2ca0"),r("498a"),Object.defineProperty(e,"__esModule",{value:!0}),e.GD=void 0;var i=n(r("b85c")),a={isGradient:function(t){return!(!t||!t.startsWith("linear")&&!t.startsWith("radial"))},doGradient:function(t,e,r,n){t.startsWith("linear")?d(e,r,t,n):t.startsWith("radial")&&s(e,r,t,n)}};function o(t){var e,r=t.substring(0,t.length-1).split("%,"),n=[],a=[],o=(0,i.default)(r);try{for(o.s();!(e=o.n()).done;){var s=e.value;n.push(s.substring(0,s.lastIndexOf(" ")).trim()),a.push(s.substring(s.lastIndexOf(" "),s.length)/100)}}catch(u){o.e(u)}finally{o.f()}return{colors:n,percents:a}}function s(t,e,r,n){for(var i=o(r.match(/radial-gradient\((.+)\)/)[1]),a=n.createCircularGradient(0,0,t<e?e/2:t/2),s=0;s<i.colors.length;s++)a.addColorStop(i.percents[s],i.colors[s]);n.setFillStyle(a)}function u(t,e,r){var n,i=t.match(/([-]?\d{1,3})deg/),a=i&&i[1]?parseFloat(i[1]):0;switch(a){case 0:n=[0,-r/2,0,r/2];break;case 90:n=[e/2,0,-e/2,0];break;case-90:n=[-e/2,0,e/2,0];break;case 180:n=[0,r/2,0,-r/2];break;case-180:n=[0,-r/2,0,r/2];break;default:var o=0,s=0,u=0,d=0;i[1]>0&&i[1]<90?(o=e/2-(e/2*Math.tan((90-i[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-i[1])*Math.PI*2/360)/2,d=Math.tan((90-i[1])*Math.PI*2/360)*o,u=-o,s=-d):i[1]>-180&&i[1]<-90?(o=-e/2+(e/2*Math.tan((90-i[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-i[1])*Math.PI*2/360)/2,d=Math.tan((90-i[1])*Math.PI*2/360)*o,u=-o,s=-d):i[1]>90&&i[1]<180?(o=e/2+(-e/2*Math.tan((90-i[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-i[1])*Math.PI*2/360)/2,d=Math.tan((90-i[1])*Math.PI*2/360)*o,u=-o,s=-d):(o=-e/2-(-e/2*Math.tan((90-i[1])*Math.PI*2/360)-r/2)*Math.sin(2*(90-i[1])*Math.PI*2/360)/2,d=Math.tan((90-i[1])*Math.PI*2/360)*o,u=-o,s=-d),n=[o,s,u,d];break}return n}function d(t,e,r,n){for(var i=u(r,t,e),a=n.createLinearGradient(i[0],i[1],i[2],i[3]),s=r.match(/linear-gradient\((.+)\)/)[1],d=o(s.substring(s.indexOf(",")+1)),c=0;c<d.colors.length;c++)a.addColorStop(d.percents[c],d.colors[c]);n.setFillStyle(a)}e.GD=a},2998:function(t,e){},"3835d":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var n=s(r("0d21")),i=s(r("09f0")),a=s(r("06c5")),o=s(r("3d8c"));function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e){return(0,n.default)(t)||(0,i.default)(t,e)||(0,a.default)(t,e)||(0,o.default)()}},"3d8c":function(t,e,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"450d":function(t,e,r){"use strict";r.r(e);var n=r("cfe0"),i=r("0727");for(var a in i)"default"!==a&&function(t){r.d(e,t,(function(){return i[t]}))}(a);var o,s=r("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);e["default"]=u.exports},"6b75":function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},"7d28":function(t,e,r){"use strict";r("99af"),Object.defineProperty(e,"__esModule",{value:!0}),e.expand=i,e.adaptor=a;var n=function(t){return{setFonts:function(e){var r=e.fontFamily,n=void 0===r?"sans-serif":r,i=e.fontSize,a=void 0===i?14:i,o=e.fontWeight,s=void 0===o?"normal":o,u=e.textStyle,d=void 0===u?"normal":u;t.font="".concat(d," ").concat(s," ").concat(a,"px ").concat(n)}}};function i(t){return Object.assign(t,n(t))}function a(t){return Object.assign(t,n(t),{setStrokeStyle:function(e){t.strokeStyle=e},setLineWidth:function(e){t.lineWidth=e},setLineCap:function(e){t.lineCap=e},setFillStyle:function(e){t.fillStyle=e},setFontSize:function(e){t.font=String(e)},setGlobalAlpha:function(e){t.globalAlpha=e},setLineJoin:function(e){t.lineJoin=e},setTextAlign:function(e){t.textAlign=e},setMiterLimit:function(e){t.miterLimit=e},setShadow:function(e,r,n,i){t.shadowOffsetX=e,t.shadowOffsetY=r,t.shadowBlur=n,t.shadowColor=i},setTextBaseline:function(e){t.textBaseline=e},createCircularGradient:function(){},draw:function(){}})}},"86b7":function(t,e,r){"use strict";(function(t){var n=r("4ea4");r("99af"),r("c975"),r("c19f"),r("ace4"),r("b680"),r("d3b7"),r("acd8"),r("e25e"),r("ac1f"),r("3ca3"),r("5319"),r("1276"),r("5cc6"),r("9a8c"),r("a975"),r("735e"),r("c1ac"),r("d139"),r("3a7b"),r("d5d6"),r("82f8"),r("e91f"),r("60bd"),r("5f96"),r("3280"),r("3fcc"),r("ca91"),r("25a1"),r("cd26"),r("3c5d"),r("2954"),r("649e"),r("219c"),r("170b"),r("b39a"),r("72f7"),r("ddb0"),r("2b3d"),Object.defineProperty(e,"__esModule",{value:!0}),e.sleep=s,e.isNumber=d,e.toPx=c,e.compareVersion=l,e.base64ToPath=h,e.pathToBase64=f,e.getImageInfo=v,r("96cf");var i=n(r("1da1")),a=n(r("3835d")),o=/^(http|\/\/)/;function s(t){return new Promise((function(e){return setTimeout(e,t)}))}var u={};function d(t){return/^-?\d+(\.\d+)?$/.test(t)}function c(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"===typeof t)return t;if(d(t))return 1*t;if("string"===typeof t){var n=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|px|%)$/g,i=n.exec(t);if(!t||!i)return 0;var a=i[3];t=parseFloat(t);var o=0;return"rpx"===a?o=uni.upx2px(t):"px"===a?o=1*t:"%"===a?o=t*c(e)/100:"em"===a&&(o=t*c(e||14)),r?1*o.toFixed(2):Math.round(o)}}function l(t,e){t=t.split("."),e=e.split(".");var r=Math.max(t.length,e.length);while(t.length<r)t.push("0");while(e.length<r)e.push("0");for(var n=0;n<r;n++){var i=parseInt(t[n],10),a=parseInt(e[n],10);if(i>a)return 1;if(i<a)return-1}return 0}function h(t){var e=/data:image\/(\w+);base64,(.*)/.exec(t)||[],r=(0,a.default)(e,3);r[1],r[2];return new Promise((function(e,r){for(var n=t.split(",")[0].split(":")[1].split(";")[0],i=atob(t.split(",")[1]),a=new ArrayBuffer(i.length),o=new Uint8Array(a),s=0;s<i.length;s++)o[s]=i.charCodeAt(s);e(URL.createObjectURL(new Blob([o],{type:n})))}))}function f(e){return new Promise((function(r,n){var i=function(){var i=new Image;i.onload=function(){var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(i,0,0);var e=t.toDataURL("image/png");r(e),t.height=t.width=0},i.src=e,i.setAttribute("crossOrigin","Anonymous"),i.src=e,i.onerror=function(r){t("error","urlToBase64 error: ".concat(e),JSON.stringify(r)," at components/zs-lime-painter/utils.js:256"),n(new Error("urlToBase64 error"))}},a=function(e){var i=new FileReader;i.onload=function(t){r(t.target.result)},i.readAsDataURL(e),i.onerror=function(e){t("error","blobToBase64 error:",JSON.stringify(e)," at components/zs-lime-painter/utils.js:267"),n(new Error("blobToBase64 error"))}},s="function"===typeof FileReader;if(o.test(e)&&s){window.URL=window.URL||window.webkitURL;var u=new XMLHttpRequest;u.open("get",e,!0),u.timeout=2e3,u.responseType="blob",u.onload=function(){200==this.status?a(this.response):i()},u.onreadystatechange=function(){0===this.status&&t("error","图片跨域了，得后端处理咯"," at components/zs-lime-painter/utils.js:287")},u.send()}else/^blob/.test(e)&&s?a(e):i()}))}function v(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(){var a=(0,i.default)(regeneratorRuntime.mark((function i(a,s){var d,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(d=/^data:image\/(\w+);base64/,/^\.|^\/(?=[^\/])/,!o.test(e)||!r){i.next=6;break}return i.next=5,f(e);case 5:e=i.sent;case 6:if(!d.test(e)){i.next=16;break}if(u[e]){i.next=15;break}return c=e,i.next=11,h(e);case 11:e=i.sent,u[c]=e,i.next=16;break;case 15:e=u[e];case 16:u[e]&&u[e].errMsg&&!n?a(u[e]):uni.getImageInfo({src:e,success:function(t){t.path=t.path.replace(/^\./,window.location.origin),t.url=e,u[e]=t,a(u[e])},fail:function(r){a({path:e}),t("error","getImageInfo:fail ".concat(e," failed ").concat(JSON.stringify(r))," at components/zs-lime-painter/utils.js:398")}});case 17:case"end":return i.stop()}}),i)})));return function(t,e){return a.apply(this,arguments)}}())}}).call(this,r("0de9")["log"])},"8fa3":function(t,e,r){"use strict";var n=r("4ea4");r("4160"),r("caad"),r("d81d"),r("b64b"),r("ac1f"),r("2532"),r("466d"),r("5319"),r("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.Layout=void 0;var i=n(r("3835d")),a=n(r("ade3"));r("96cf");var o=n(r("1da1")),s=n(r("d4ec")),u=n(r("bee2")),d=r("86b7"),c=function(){function t(){(0,s.default)(this,t),this.layoutHeight=0,this.layoutWidth=0,this.uuid=0}return(0,u.default)(t,[{key:"init",value:function(t,e,r){this.ctx=t,this.root=e,this.layoutWidth=e.width||0,this.layoutHeight=e.height||0,this.uuid=0,this.isH5PathToBase64=r}},{key:"getNodeTree",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var r,n,i,a,o,s,u,d,c,l,h,f,v,p,g,b,m,w,x=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=x.length>1&&void 0!==x[1]?x[1]:{},n=x.length>2&&void 0!==x[2]?x[2]:0,i=x.length>3&&void 0!==x[3]?x[3]:[],a=x.length>4?x[4]:void 0,o=Object.assign({},this.getComputedStyle(e,r,n)),t.next=7,this.getAttributes(e);case 7:if(s=t.sent,u={id:this.uuid++,parent:r,computedStyle:o,rules:e.rules,attributes:Object.assign({},s),name:(null===e||void 0===e?void 0:e.type)||"view",isRoot:!(null===e||void 0===e?void 0:e.type)&&"{}"==JSON.stringify(r)},"{}"!==JSON.stringify(r)||e.type?u.layoutBox=Object.assign({left:0,top:0},this.getLayoutBox(u,r,n,i,a)):(d=o.left,c=void 0===d?0:d,l=o.top,h=void 0===l?0:l,f=o.width,v=void 0===f?0:f,p=o.height,g=void 0===p?0:p,u.layoutBox={left:c,top:h,width:v,height:g}),!(null===e||void 0===e?void 0:e.views)){t.next=25;break}b=[],u.children=[],m=0;case 14:if(!(m<e.views.length)){t.next=24;break}return w=e.views[m],t.t0=b,t.next=19,this.getNodeTree(w,u,m,b,e);case 19:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 21:m++,t.next=14;break;case 24:u.children=b;case 25:return t.abrupt("return",u);case 26:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getComputedStyle",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},o=t.name||t.type,s="{}"!=JSON.stringify(r)||o?t.css:t;if(!s)return n;var u=["color","fontSize","lineHeight","verticalAlign","fontWeight","textAlign"];r.computedStyle&&u.forEach((function(t){(s[t]||r.computedStyle[t])&&(s[t]=s[t]||r.computedStyle[t])}));for(var c=function(){var t=h[l],u=s[t];if("views"==t)return"continue";if(/^(box)?shadow$/i.test(t)){var c=u.split(" ").map((function(t){return/^\d/.test(t)?(0,d.toPx)(t):t}));return n.boxShadow=c,"continue"}if(/^border/i.test(t)&&!/radius$/i.test(t)){var f,v=t.match(/^border([BTRLa-z]+)?/)[0],p=t.match(/[W|S|C][a-z]+/),g=u.replace(/([\(,])\s+|\s+([\),])/g,"$1$2").split(" ").map((function(t){return/^\d/.test(t)?(0,d.toPx)(t,"",!0):t}));return n[v]=(f={},(0,a.default)(f,v+"Width",((0,d.isNumber)(g[0])?g[0]:0)||1),(0,a.default)(f,v+"Style",g[1]||"solid"),(0,a.default)(f,v+"Color",g[2]||"black"),f),1==g.length&&p&&(n[v][v+p[0]]=g[0]),"continue"}if(/^background(color)?$/i.test(t))return n["backgroundColor"]=u,"continue";if(/padding|margin|radius/i.test(t)){var b=/radius$/i.test(t),m=b?"borderRadius":t.match(/[a-z]+/)[0],w=[0,0,0,0].map((function(t,e){return b?["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"][e]:[m+"Top",m+"Right",m+"Bottom",m+"Left"][e]}));if("padding"===t||"margin"===t||/^(border)?radius$/i.test(t)){var x,y=(null===u||void 0===u?void 0:u.split(" ").map((function(t){return/^\d/.test(t)&&(0,d.toPx)(t,s["width"])}),[]))||[0],k=b?"borderRadius":t,P=(0,i.default)(y,4),T=P[0],S=P[1],R=P[2],I=P[3];n[k]=(x={},(0,a.default)(x,w[0],T),(0,a.default)(x,w[1],(0,d.isNumber)(S)?S:T),(0,a.default)(x,w[2],(0,d.isNumber)(R)?R:T),(0,a.default)(x,w[3],(0,d.isNumber)(I)?I:S||T),x)}else{var M;if("object"===typeof n[m])n[m][t]=(0,d.toPx)(u,s["width"]);else n[m]=(M={},(0,a.default)(M,w[0],n[m]||0),(0,a.default)(M,w[1],n[m]||0),(0,a.default)(M,w[2],n[m]||0),(0,a.default)(M,w[3],n[m]||0),M),n[m][t]=(0,d.toPx)(u,s["width"])}return"continue"}if(/^(width|height)$/i.test(t))return/%$/.test(u)?n[t]=(0,d.toPx)(u,r.layoutBox[t]):n[t]=/px|rpx$/.test(u)?(0,d.toPx)(u):u,"continue";if(/^transform$/i.test(t))return n[t]={},u.replace(/([a-zA-Z]+)\(([0-9,-\.%rpxdeg\s]+)\)/g,(function(e,r,i){var a=i.split(",").map((function(t){return t.replace(/(^\s*)|(\s*$)/g,"")})),o=function(t,e){return t.includes("deg")?1*t:e&&!/%$/.test(e)?(0,d.toPx)(t,e):t};r.includes("matrix")?n[t][r]=a.map((function(t){return 1*t})):r.includes("rotate")?n[t][r]=1*i.match(/^-?\d+(\.\d+)?/)[0]:/[X, Y]/.test(r)?n[t][r]=/[X]/.test(r)?o(a[0],s["width"]):o(a[0],s["height"]):(n[t][r+"X"]=o(a[0],s["width"]),n[t][r+"Y"]=o(a[1]||a[0],s["height"]))})),"continue";if(/^transformOrigin/i.test(t))return n[t]=u,"continue";if(/%/.test(u)){var O=r.layoutBox,B=O.width,j=O.height,L=(O.left,O.top,e.root),N=L.width,C=L.height;n.position;n[t]="width"==t?(0,d.toPx)(u,B||N):"height"==t?(0,d.toPx)(u,j||C):"left"==t||"top"==t?u:(0,d.toPx)(u,s["width"])}else n[t]=/px|rpx$/.test(u)?(0,d.toPx)(u):/em$/.test(u)&&"text"==o?(0,d.toPx)(u,s["fontSize"]):u},l=0,h=Object.keys(s);l<h.length;l++)c();return/image/.test(t.name||t.type)&&!n.mode&&(n.mode=t.mode||"scaleToFill",s.width&&"auto"!=s.width||s.height&&"auto"!=s.width||(n.mode="")),n}},{key:"getLayoutBox",value:function(t){var e,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o={},s=t||{},u=s.name,c=s.computedStyle,l=(s.layoutBox,s.attributes);s.isRoot;if(!u)return o;var h=this.ctx,f=n.layoutBox,v=void 0===f?this.root:f,p=n.computedStyle,g=c.verticalAlign,b=c.left,m=c.top,w=c.width,x=c.height,y=c.fontSize,k=void 0===y?14:y,P=c.lineHeight,T=void 0===P?"1.4em":P,S=c.maxLines,R=c.fontWeight,I=c.fontFamily,M=c.textStyle,O=c.position,B=c.display,j=c.padding,L=void 0===j?{}:j,N=c.margin,C=void 0===N?{}:N,_=L.paddingTop,F=void 0===_?0:_,W=L.paddingRight,$=void 0===W?0:W,A=L.paddingBottom,H=void 0===A?0:A,D=L.paddingLeft,z=void 0===D?0:D,J=C.marginTop,G=void 0===J?0:J,E=C.marginRight,U=void 0===E?0:E,X=C.marginBottom,q=void 0===X?0:X,Y=C.marginLeft,V=void 0===Y?0:Y,Q=a[i-1]||{},Z=Q.layoutBox,K=Q.computedStyle,tt=Q.name,et=a[i+1]||{},rt=et.layoutBox,nt=(et.computedStyle,et.name,(null===K||void 0===K||null===(e=K.margin)||void 0===e?void 0:e.marginBottom)||0),it=(null===K||void 0===K||null===(r=K.margin)||void 0===r?void 0:r.marginRight)||0;if(/%$/.test(b)&&(b=(0,d.toPx)(b,v.width)),/%$/.test(m)&&(m=(0,d.toPx)(m,v.height)),"relative"==O&&(b+=v.left,m+=v.top),"text"===u){var at=l.text||"";T=(0,d.toPx)(T,k),h.save(),h.setFonts({fontFamily:I,fontSize:k,fontWeight:R,textStyle:M});var ot=0==i,st="inlineBlock"===B,ut="block"===B||"block"===(null===K||void 0===K?void 0:K.display),dt=ot&&!rt||!(null===n||void 0===n?void 0:n.id),ct=ot||ut?0:Z.offsetRight||0,lt=at.split("\n"),ht=1,ft="",vt=c.textIndent||0;dt||st?(ft=at,ht=Math.max(lt.length,Math.ceil(h.measureText(at,k).width/((w||v.width)-h.measureText("!",k).width/2)))):lt.map((function(t,e){ht+=e;for(var r=t.split(""),n=0;n<r.length;n++){var i=r[n],a=ft+i,o=h.measureText(a,k).width;1==ht&&(o=o+(ut?0:ct)+vt),o>(w||v.width)?(ht++,ft=i):ft=a}})),st||(o.offsetLeft=((0,d.isNumber)(b)||ut||dt?vt:ct)+z+V),o.offsetTop=F;var pt=h.measureText(ft,k).width,gt=(ht>1?v.width:pt+((null===o||void 0===o?void 0:o.offsetLeft)||0))+$;st||(o.offsetRight=(b||0)+o.offsetLeft+(w||(ut?v.width:pt))+$+U);var bt=Z?Z.left+Z.width:0,mt=function(){return st?(bt+gt>v.width||ot?v.left:bt+it)+V:b||v.left},wt=function(){return st?gt+z+$:w||(!dt||ut?v.width:gt>v.width-o.left||ht>1?v.width-o.left:gt)},xt=function(){return x||(ht>1?(S||ht)*T+F+H:T+F+H)},yt=function(){var t=m;return t||(t=ot?v.top:1==ht&&gt<v.width&&"text"===tt&&!ut&&!st||Z.width<v.width&&!(st&&bt+gt>v.width)?Z.top:Z.top+Z.height-((null===n||void 0===n?void 0:n.id)&&((null===K||void 0===K?void 0:K.lineHeight)||0))),"bottom"===g&&(t=v.top+(v.height-o.height||0)),"middle"===g&&(t=v.top+(v.height?(v.height-o.height||0)/2:0)),t+G+(ut&&(null===K||void 0===K?void 0:K.lineHeight)||0)+(bt+gt>v.width?nt:0)};o.left=mt(),o.width=wt(),o.height=xt(),o.top=yt(),p&&!p.height&&(v.height=o.top-v.top+o.height),h.restore()}else if(["view","qrcode"].includes(u))o.left=(b||v.left)+V-U,o.width=(w||(null===v||void 0===v?void 0:v.width))-z-$,o.height=x||0,(0,d.isNumber)(m)?o.top=m+G:o.top=(Z&&Z.top+Z.height||v.top)+G+nt;else if("image"===u){var kt=l.width,Pt=l.height,Tt=Z&&Z.left+Z.width;if((0,d.isNumber)(b)?o.left=b+V-U:o.left=(Z&&(Tt<v.width?Tt:v.left)||v.left)+V-U,(0,d.isNumber)(w)?o.width=w:o.width=Math.round((0,d.isNumber)(x)?kt*x/Pt:null===v||void 0===v?void 0:v.width),(0,d.isNumber)(x))o.height=x;else{var St=Math.round(o.width*Pt/kt);o.height=Math.min(St,null===v||void 0===v?void 0:v.height)}(0,d.isNumber)(m)?o.top=m+G:o.top=(Z&&(Tt<v.width?Tt:Z.top+Z.height)||v.top)+G+nt}return o.top+o.height+q>this.layoutHeight&&(this.layoutHeight=o.top+o.height+q),o}},{key:"getAttributes",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var r,n,i,a,o,s,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={},!(null===e||void 0===e?void 0:e.url)&&!(null===e||void 0===e?void 0:e.src)){t.next=16;break}return r.src=e.url||(null===e||void 0===e?void 0:e.src),t.next=5,(0,d.getImageInfo)(r.src,this.isH5PathToBase64);case 5:if(t.t0=t.sent,t.t0){t.next=8;break}t.t0={};case 8:n=t.t0,i=n.width,a=void 0===i?0:i,o=n.height,s=void 0===o?0:o,u=n.path,c=n.url,r=Object.assign({},r,{width:a,height:s,src:u,url:c});case 16:return(null===e||void 0===e?void 0:e.text)&&(r.text=e.text),t.abrupt("return",r);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"calcNode",value:function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getNodeTree(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();e.Layout=c},b85c:function(t,e,r){"use strict";r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=a;var n=i(r("06c5"));function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=(0,n.default)(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r["return"]||r["return"]()}finally{if(u)throw o}}}}},baa5:function(t,e,r){var n=r("23e7"),i=r("e58c");n({target:"Array",proto:!0,forced:i!==[].lastIndexOf},{lastIndexOf:i})},cb29:function(t,e,r){var n=r("23e7"),i=r("81d5"),a=r("44d2");n({target:"Array",proto:!0},{fill:i}),a("fill")},cfe0:function(t,e,r){"use strict";var n;r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return a})),r.d(e,"a",(function(){return n}));var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.use2dCanvas?r("v-uni-canvas",{style:t.size+";"+t.customStyle,attrs:{id:t.canvasId,type:"2d"}}):r("v-uni-canvas",{style:t.size+";"+t.customStyle,attrs:{"canvas-id":t.canvasId,id:t.canvasId,width:t.boardWidth*t.dpr,height:t.boardHeight*t.dpr}})},a=[]},e3e3:function(t,e,r){"use strict";var n=r("4ea4");r("99af"),r("a9e3"),r("d3b7"),r("ac1f"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,r("96cf");var i=n(r("1da1")),a=r("86b7"),o=r("ebb7"),s=r("8fa3"),u=r("7d28"),d={name:"zs-lime-painter",props:{board:Object,pathType:{type:String},fileType:{type:String,default:"png"},quality:{type:Number,default:1},width:[Number,String],height:[Number,String],pixelRatio:Number,customStyle:String,isRenderImage:Boolean,isH5PathToBase64:Boolean,sleep:{type:Number,default:1e3/60},beforeDelay:{type:Number,default:1e3/60},afterDelay:Number},data:function(){return{canvasId:"l-painter".concat(this._uid),use2dCanvas:!1,draw:null,ctx:null,canvasHeight:0,canvasWidth:0,layout:new s.Layout,isDrawIng:!1}},computed:{size:function(){return"width:".concat(this.boardWidth,"px; height: ").concat(this.boardHeight,"px;")},dpr:function(){return this.pixelRatio||uni.getSystemInfoSync().pixelRatio},boardWidth:function(){var t=this.board||{},e=t.width;return(0,a.toPx)(this.width||e)},boardHeight:function(){var t=this.board||{},e=t.height,r=this.height,n=this.canvasHeight;return/^auto$/.test(r||e)?n||1:(0,a.toPx)(r||e)}},watch:{size:function(){}},mounted:function(){var t=this;this.$watch("board",function(){var e=(0,i.default)(regeneratorRuntime.mark((function e(r,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("{}"!==JSON.stringify(r)&&r){e.next=2;break}return e.abrupt("return");case 2:if(!t.beforeDelay){e.next=5;break}return e.next=5,(0,a.sleep)(t.beforeDelay);case 5:t.render();case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),{deep:!0,immediate:!0})},methods:{update:function(t,e){var r=this;return(0,i.default)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r.draw=null,r.isDrawIng=!1,n.next=4,new Promise((function(t){return r.$nextTick(t)}));case 4:return n.next=6,(0,a.sleep)(200);case 6:return n.abrupt("return",r.render(t,e));case 7:case"end":return n.stop()}}),n)})))()},render:function(){var t=arguments,e=this;return(0,i.default)(regeneratorRuntime.mark((function r(){var n,s,u,d,c,l,h,f,v,p,g,b,m,w;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:{},s=t.length>1&&void 0!==t[1]&&t[1],!e.isDrawIng){r.next=4;break}return r.abrupt("return",e.update(n,s));case 4:return e.isDrawIng=!0,u="{}"!=JSON.stringify(n),r.next=8,e.getContext();case 8:if(d=r.sent,c=e.use2dCanvas,l=e.boardWidth,h=e.boardHeight,f=e.board,v=e.canvas,p=e.isH5PathToBase64,g=e.sleep,b=e.afterDelay,!c||v){r.next=12;break}return r.abrupt("return",Promise.reject(new Error("render: fail canvas has not been created")));case 12:if(e.boundary={top:0,left:0,width:l,height:h},s||d.clearRect(0,0,l,h),e.draw&&!u||(e.draw=new o.Draw(d,v,c,p,g)),e.layout.init(d,e.boundary,p),!(u||f&&"{}"!=JSON.stringify(f))){r.next=20;break}return r.next=19,e.layout.calcNode(u?n:Object.assign({},f,{height:f.type||"auto"!=f.height?f.height:h}));case 19:e.node=r.sent;case 20:if(m=e.layout.layoutHeight,!/auto/.test(e.height||f.height)||e.canvasHeight){r.next=24;break}return e.canvasHeight=m,r.abrupt("return",e.update(n,s));case 24:if(!e.node){r.next=27;break}return r.next=27,null===(w=e.draw)||void 0===w?void 0:w.drawNode(e.node);case 27:return r.next=29,new Promise((function(t){return e.$nextTick(t)}));case 29:if(c||s){r.next=32;break}return r.next=32,e.canvasDraw(d);case 32:if(!b){r.next=35;break}return r.next=35,(0,a.sleep)(b);case 35:return e.$emit("done"),e.isRenderImage&&!s&&e.isDrawIng&&e.canvasToTempFilePath().then(function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(r){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("base64"!=e.pathType){t.next=11;break}if(!/^data:image\/(\w+);base64/.test(r.tempFilePath)){t.next=5;break}e.$emit("success",r.tempFilePath),t.next=9;break;case 5:return t.next=7,(0,a.pathToBase64)(r.tempFilePath);case 7:n=t.sent,e.$emit("success",n);case 9:t.next=19;break;case 11:if("url"!=e.pathType){t.next=18;break}return t.next=14,(0,a.base64ToPath)(r.tempFilePath);case 14:i=t.sent,e.$emit("success",i),t.next=19;break;case 18:e.$emit("success",r.tempFilePath);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$emit("fail",new Error(JSON.stringify(t)))})),e.isDrawIng=!1,r.abrupt("return",Promise.resolve({ctx:d,draw:e.draw,node:e.node}));case 39:case"end":return r.stop()}}),r)})))()},custom:function(t){var e=this;return(0,i.default)(regeneratorRuntime.mark((function r(){var n,i,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.render({},!0);case 2:return n=r.sent,i=n.ctx,a=n.draw,i.save(),r.next=8,t(i,a);case 8:return i.restore(),r.abrupt("return",Promise.resolve(!0));case 10:case"end":return r.stop()}}),r)})))()},single:function(){var t=arguments,e=this;return(0,i.default)(regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.length>0&&void 0!==t[0]?t[0]:{},r.next=3,e.render(n,!0);case 3:return i=r.sent,r.abrupt("return",Promise.resolve(i));case 5:case"end":return r.stop()}}),r)})))()},canvasDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.ctx;return new Promise((function(r){e.draw(t,r)}))},getContext:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,n,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.ctx||!t.inited){e.next=2;break}return e.abrupt("return",Promise.resolve(t.ctx));case 2:return r=t.type,t.use2dCanvas,n=t.dpr,i=t.boardWidth,a=t.boardHeight,o=function(){return new Promise((function(e){uni.createSelectorQuery().in(t).select("#".concat(t.canvasId)).boundingClientRect().exec((function(r){if(r){var n=uni.createCanvasContext(t.canvasId,t);t.inited||(t.inited=!0,t.use2dCanvas=!1,t.canvas=r),t.ctx=(0,u.expand)(n),e(t.ctx)}}))}))},e.abrupt("return",o());case 7:return e.abrupt("return",new Promise((function(e){uni.createSelectorQuery().in(t).select("#".concat(t.canvasId)).node().exec((function(o){var s=o[0].node;s||(t.use2dCanvas=!1,e(t.getContext()));var d=s.getContext(r);t.inited||(t.inited=!0,s.width=i*n,s.height=a*n,t.use2dCanvas=!0,t.canvas=s,d.scale(n,n)),t.ctx=(0,u.adaptor)(d),e(t.ctx)}))})));case 8:case"end":return e.stop()}}),e)})))()},canvasToTempFilePath:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=this.use2dCanvas,n=this.canvasId,i=this.dpr;return new Promise((function(a,o){var s=t.boundary||t,u=s.top,d=void 0===u?0:u,c=s.left,l=void 0===c?0:c,h=s.width,f=s.height,v=h*i,p=f*i,g=e||t,b=g.fileType,m=g.quality,w={x:l,y:d,width:h,height:f,destWidth:v,destHeight:p,canvasId:n,fileType:b,quality:m,success:a,fail:o};r&&(delete w.canvasId,w.canvas=t.canvas),uni.canvasToTempFilePath(w,t)}))}}};e.default=d},ebb7:function(t,e,r){"use strict";(function(t){var n=r("4ea4");r("cb29"),r("4de4"),r("caad"),r("c975"),r("a15b"),r("d81d"),r("13d5"),r("b64b"),r("d3b7"),r("07ac"),r("ac1f"),r("2532"),r("5319"),r("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.Draw=void 0;var i=n(r("b85c"));r("96cf");var a=n(r("1da1")),o=n(r("ade3")),s=n(r("3835d")),u=n(r("d4ec")),d=n(r("bee2")),c=r("86b7"),l=r("21d5"),h=n(r("2998")),f=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0;(0,u.default)(this,e),this.ctx=t,this.canvas=r||null,this.use2dCanvas=n,this.isH5PathToBase64=i,this.sleep=a}return(0,d.default)(e,[{key:"roundRect",value:function(t,e,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!(i<0)){var s=this.ctx;if(s.beginPath(),i){var u=i||{},d=u.borderTopLeftRadius,c=void 0===d?i||0:d,l=u.borderTopRightRadius,h=void 0===l?i||0:l,f=u.borderBottomRightRadius,v=void 0===f?i||0:f,p=u.borderBottomLeftRadius,g=void 0===p?i||0:p;s.arc(t+r-v,e+n-v,v,0,.5*Math.PI),s.lineTo(t+g,e+n),s.arc(t+g,e+n-g,g,.5*Math.PI,Math.PI),s.lineTo(t,e+c),s.arc(t+c,e+c,c,Math.PI,1.5*Math.PI),s.lineTo(t+r-h,e),s.arc(t+r-h,e+h,h,1.5*Math.PI,2*Math.PI),s.lineTo(t+r,e+n-v)}else s.rect(t,e,r,n);s.closePath(),o&&s.stroke(),a&&s.fill()}}},{key:"setTransform",value:function(t,e){var r=e.transform,n=e.transformOrigin,i=void 0===n?"center center":n,a=this.ctx,o=r||{},s=o.scaleX,u=void 0===s?1:s,d=o.scaleY,l=void 0===d?1:d,h=o.translateX,f=void 0===h?0:h,v=o.translateY,p=void 0===v?0:v,g=o.rotate,b=void 0===g?0:g,m=o.skewX,w=void 0===m?0:m,x=o.skewY,y=void 0===x?0:x,k=t.left,P=t.top,T=t.width,S=t.height;f=(0,c.toPx)(f,T)||0,p=(0,c.toPx)(p,S)||0;var R={top:(0,c.toPx)("0%",1),center:(0,c.toPx)("50%",1,!0),bottom:(0,c.toPx)("100%",1)},I={left:(0,c.toPx)("0%",1),center:(0,c.toPx)("50%",1,!0),right:(0,c.toPx)("100%",1)};i=i.split(" ").filter((function(t,e){return e<2})).reduce((function(t,e){if(/\d+/.test(e)){var r=(0,c.toPx)(e,1,!0)/(/px|rpx$/.test(e)?(0,c.isNumber)(t.x)?S:T:1);return(0,c.isNumber)(t.x)?Object.assign(t,{y:r}):Object.assign(t,{x:r})}return(0,c.isNumber)(I[e])&&!(0,c.isNumber)(t.x)?Object.assign(t,{x:I[e]}):Object.assign(t,{y:R[e]})}),{}),a.scale(u,l);var M={x:T*(u>0?1:-1)*i.x+(k+f)/u,y:S*(l>0?1:-1)*i.y+(P+p)/l};return a.translate(M.x,M.y),b&&a.rotate(b*Math.PI/180),(w||y)&&a.transform(1,Math.tan(y*Math.PI/180),Math.tan(w*Math.PI/180),1,0,0),{x:-T*i.x,y:-S*i.y,w:T,h:S}}},{key:"setBackground",value:function(t,e,r){var n=this.ctx;t?l.GD.isGradient(t)?l.GD.doGradient(t,e,r,n):n.setFillStyle(t):n.setFillStyle("transparent")}},{key:"setShadow",value:function(t){var e=t.boxShadow,r=void 0===e?[]:e,n=this.ctx;if(r.length){var i=(0,s.default)(r,4),a=i[0],o=i[1],u=i[2],d=i[3];n.setShadow(a,o,u,d)}}},{key:"setBorder",value:function(t,e){var r,n=this.ctx,i=t.width,a=t.height,s=e.border,u=e.borderBottom,d=e.borderTop,c=e.borderRight,l=e.borderLeft,h=e.borderRadius,f=s||{},v=f.borderWidth,p=void 0===v?0:v,g=f.borderStyle,b=f.borderColor,m=u||{},w=m.borderBottomWidth,x=void 0===w?p:w,y=m.borderBottomStyle,k=void 0===y?g:y,P=m.borderBottomColor,T=void 0===P?b:P,S=d||{},R=S.borderTopWidth,I=void 0===R?p:R,M=S.borderTopStyle,O=void 0===M?g:M,B=S.borderTopColor,j=void 0===B?b:B,L=c||{},N=(L.borderRightWidth,L.borderRightStyle,L.borderRightColor,l||{}),C=N.borderLeftWidth,_=void 0===C?p:C,F=N.borderLeftStyle,W=void 0===F?g:F,$=N.borderLeftColor,A=void 0===$?b:$,H=h||(r={r:h},(0,o.default)(r,"r",h),(0,o.default)(r,"r",h),(0,o.default)(r,"r",h),r),D=H.borderTopLeftRadius,z=void 0===D?h||0:D,J=H.borderTopRightRadius,G=void 0===J?h||0:J,E=H.borderBottomRightRadius,U=void 0===E?h||0:E,X=H.borderBottomLeftRadius,q=void 0===X?h||0:X;if(u||l||d||c||s){var Y=function(t,e,r){"dashed"==e?n.setLineDash([Math.ceil(6*t),Math.ceil(6*t)]):"dotted"==e&&n.setLineDash([t,t]),n.setStrokeStyle(r)},V=function(t,e,r,i,a,o,s,u,d,c,l,h,f,v){n.save(),n.setLineWidth(h),Y(h,f,v),n.beginPath(),n.arc(t,e,s,Math.PI*d,Math.PI*c),n.lineTo(r,i),n.arc(a,o,u,Math.PI*c,Math.PI*l),n.stroke(),n.restore()};n.save(),this.setOpacity(e);var Q=this.setTransform(t,e),Z=Q.x,K=Q.y;s&&(n.setLineWidth(p),Y(p,g,b),this.roundRect(Z,K,i,a,h,!1,!!b),n.restore()),u&&V(Z+i-U,K+a-U,Z+q,K+a,Z+q,K+a-q,U,q,.25,.5,.75,x,k,T),l&&V(Z+q,K+a-q,Z,K+z,Z+z,K+z,q,z,.75,1,1.25,_,W,A),d&&V(Z+z,K+z,Z+i-G,K,Z+i-G,K+G,z,G,1.25,1.5,1.75,I,O,j),c&&V(Z+i-G,K+G,Z+i,K+a-U,Z+i-U,K+a-U,G,U,1.75,2,.25,I,O,j)}}},{key:"setOpacity",value:function(t){var e=t.opacity,r=void 0===e?1:e;this.ctx.setGlobalAlpha(r)}},{key:"drawView",value:function(t,e){var r=this.ctx,n=t.width,i=t.height,a=e||{},o=a.borderRadius,s=void 0===o?0:o,u=a.backgroundColor;r.save(),this.setOpacity(e);var d=this.setTransform(t,e),c=d.x,l=d.y;this.setShadow(e),this.setBackground(u,n,i),this.roundRect(c,l,n,i,s,!0,!1),r.restore(),this.setBorder(t,e)}},{key:"drawImage",value:function(){var e=(0,a.default)(regeneratorRuntime.mark((function e(r){var n,i,o,s=this,u=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},i=u.length>2&&void 0!==u[2]?u[2]:{},o=!(u.length>3&&void 0!==u[3])||u[3],e.next=5,new Promise(function(){var e=(0,a.default)(regeneratorRuntime.mark((function e(u,d){var l,h,f,v,p,g,b,m,w,x,y,k,P,T,S,R,I,M,O,B,j,L,N,C,_,F,W,$,A,H,D;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l=s.ctx,h=s.sleep,f=s.canvas,v=i.borderRadius,p=void 0===v?0:v,g=i.mode,b=i.padding,m=void 0===b?{}:b,w=i.backgroundColor,x=m.paddingTop,y=void 0===x?0:x,k=m.paddingLeft,P=void 0===k?0:k,T=m.paddingRight,S=void 0===T?0:T,R=m.paddingBottom,I=void 0===R?0:R,M=n.left,O=n.top,B=n.width,j=n.height,l.save(),o||(s.setOpacity(i),L=s.setTransform(n,i),N=L.x,C=L.y,w&&s.setBackground(w,B,j),M=N,O=C,s.setShadow(i),s.roundRect(M,O,B,j,p,!!p,!1)),l.clip(),_=function(t){M+=P,O+=y,B=B-P-S,j=j-y-I;var e=t.width,r=t.height,n=t.src,i=0,a=0,o=B/j,s=e/r;switch(e||(g="scaleToFill"),g){case"aspectFit":o>=s?(e=j*s,r=j,i=M+Math.round(B-e)/2,a=O):(e=B,r=B/s,i=M,a=O+Math.round(j-r)/2),l.drawImage(n,i,a,e,r);break;case"aspectFill":o>=s?r=e/o:(e=r*o,i=Math.round(((t.width||B)-e)/2)),l.drawImage(n,i,a,e,r,M,O,B,j);break;default:l.drawImage(n,M,O,B,j)}},F=function(){l.restore(),s.setBorder(n,i),setTimeout(u,h)},W=function e(r){if(s.use2dCanvas){var n=f.createImage();n.onload=function(){r.src=n,_(r),F()},n.onerror=(0,a.default)(regeneratorRuntime.mark((function n(){var i,a,o,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!r.url){n.next=10;break}return n.next=3,(0,c.getImageInfo)(r.url,s.isH5PathToBase64,!0);case 3:i=n.sent,a=i.path,o=i.width,d=i.height,e({src:a,width:o,height:d}),n.next=12;break;case 10:t("error","createImage fail: ".concat(JSON.stringify(r))," at components/zs-lime-painter/draw.js:331"),u(!0);case 12:case"end":return n.stop()}}),n)}))),n.src=r.src}else _(r),F()},"string"!==typeof r){e.next=21;break}return e.next=14,(0,c.getImageInfo)(r,s.isH5PathToBase64);case 14:$=e.sent,A=$.path,H=$.width,D=$.height,W({src:A,width:H,height:D}),e.next=22;break;case 21:W(r);case 22:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}()},{key:"drawText",value:function(t,e,r,n){var i=this.ctx,a=e.width,o=e.height,s=e.offsetLeft,u=void 0===s?0:s,d=e.offsetTop,l=void 0===d?0:d,h=r.color,f=void 0===h?"#000000":h,v=r.lineHeight,p=void 0===v?"1.4em":v,g=r.fontSize,b=void 0===g?14:g,m=r.fontWeight,w=r.fontFamily,x=r.textStyle,y=r.textAlign,k=void 0===y?"left":y,P=r.verticalAlign,T=void 0===P?"top":P,S=r.backgroundColor,R=r.maxLines,I=(r.display,r.padding,r.borderRadius),M=void 0===I?0:I,O=r.textDecoration;if(p=(0,c.toPx)(p,b),t){i.save(),this.setOpacity(r);var B=this.setTransform(e,r),j=B.x,L=B.y;i.setTextBaseline(T),i.setFonts({fontFamily:w,fontSize:b,fontWeight:m,textStyle:x}),i.setTextAlign(k),S&&(this.setBackground(S,a,o),this.roundRect(j,L,a,o,M,1,0)),L+=l,this.setShadow(r),i.setFillStyle(f);var N={};if(n&&n.word.length>0)for(var C=0;C<n.word.length;C++){var _=0,F=void 0;while((F=t.indexOf(n.word[C],_))>-1){N[F]={reset:!0};for(var W=0;W<n.word[C].length;W++)N[F+W]={reset:!0};_=F+1}}switch(k){case"left":break;case"center":j+=.5*a;break;case"right":j+=a;break;default:break}var $=i.measureText(t).width,A=Math.ceil($/a)*p,H=Math.ceil((o-A)/2);switch(H<0&&(H=0),T){case"top":break;case"middle":L+=b/2;break;case"bottom":L+=b;break;default:break}var D=function(t,e,r){var n=uni.getSystemInfoSync(),a=n.system;switch(/win|mac/.test(a)&&(e+=b/3),T){case"top":break;case"middle":e-=b/2;break;case"bottom":e-=b;break;default:break}var o=t;switch(k){case"left":t=t,o+=r;break;case"center":t-=r/2,o=t+r;break;case"right":o=t,t-=r;break;default:break}O&&(i.setLineWidth(b/13),i.beginPath(),/\bunderline\b/.test(O)&&(e-=.8*U,i.moveTo(t,e),i.lineTo(o,e)),/\boverline\b/.test(O)&&(e+=U,i.moveTo(t,e-p),i.lineTo(o,e-p)),/\bline-through\b/.test(O)&&(i.moveTo(t,e-p/2),i.lineTo(o,e-p/2)),i.closePath(),i.setStrokeStyle(f),i.stroke())},z=function(t,e,r){for(var a=Object.keys(N),o=0;o<a.length;o++){var s=N[a[o]];i.save(),i.setFillStyle(n.color),s.char&&i.fillText(s.char,s.x,s.y),i.restore()}},J=function(t,e){if(t){var r=Math.round(i.measureText(" ").width),n=Math.round(i.measureText("　").width),a=Math.round(i.measureText(e).width),o="",s=1;return a==n?(o="　",s=1):(o=" ",s=Math.ceil(a/r)),{char:new Array(s).fill(o).join(""),width:a}}return{char:e}},G=function(t,e,r,n){N[e].x=r,N[e].y=n,N[e].char=t},E=function(t,e,r,n,a){var o=a.startIndex,s=void 0===o?0:o,u=(a.endIndex,r);/·/.test(r)&&(u=u.replace(/·/g,"."),n=i.measureText(u).width);for(var d=r.split(""),c=t,l=0;l<e.length;l++){var h=e[l],f=h-s,v=d[f];if(v){var p=J(N[h],v),g=p.char,b=p.width;d[f]=g,"center"==k&&(c=t-.5*(n-b)),"right"==k&&(c=t-n+b),G(v,h,c+i.measureText(u.substring(0,f)).width,L+U)}}return d},U=Math.ceil((p-b)/2);if($+u<=a&&!t.includes("\n")){j+=u;var X=Object.keys(N),q="";return X&&(q=E(j,X,t,$,{}),z()),i.fillText(q.join(""),j,L+U),L+=p,D(j,L,$),i.restore(),void this.setBorder(e,r)}for(var Y=t.split(""),V=L,Q=j,Z="",K=0,tt=0,et=0;et<=Y.length;et++){var rt=Y[et]||"",nt="\n"===rt,it=""==rt;rt=nt?"":rt;var at=Z+rt,ot=i.measureText(at).width;if(K>=R)break;if(0==K?(ot+=u,Q=j+u):(ot=ot,Q=j),ot>a||nt||it){var st=et;if(K++,Z=it&&ot<=a?at:Z,K===R&&ot>a){while(i.measureText("".concat(Z,"...")).width>a){if(Z.length<=1)break;Z=Z.substring(0,Z.length-1)}Z+="..."}var ut=Object.keys(N),dt="";if(ut&&(dt=E(j,ut,Z,ot,{startIndex:tt,endIndex:st}),z()),i.fillText(dt.join(""),Q,L+U),L+=p,D(Q,L,ot),Z=rt,tt=st+(nt?1:0),L+p>V+o)break}else Z=at}i.restore(),this.setBorder(e,r)}}},{key:"drawNode",value:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(e){var r,n,a,o,s,u,d,c,l,f,v,p,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.layoutBox,n=e.computedStyle,a=e.attributes,o=e.name,s=e.rules,u=e.children,d=e.attributes,c=d.src,l=d.text,"view"!==o){t.next=6;break}this.drawView(r,n),t.next=12;break;case 6:if("image"!==o||!c){t.next=11;break}return t.next=9,this.drawImage(a,r,n,!1);case 9:t.next=12;break;case 11:"text"===o?this.drawText(l,r,n,s):"qrcode"===o&&(null===h.default||void 0===h.default?void 0:h.default.api)&&h.default.api.draw(l,this,r,n);case 12:if(u){t.next=14;break}return t.abrupt("return");case 14:f=Object.values?Object.values(u):Object.keys(u).map((function(t){return u[t]})),v=(0,i.default)(f),t.prev=16,v.s();case 18:if((p=v.n()).done){t.next=24;break}return g=p.value,t.next=22,this.drawNode(g);case 22:t.next=18;break;case 24:t.next=29;break;case 26:t.prev=26,t.t0=t["catch"](16),v.e(t.t0);case 29:return t.prev=29,v.f(),t.finish(29);case 32:case"end":return t.stop()}}),t,this,[[16,26,29,32]])})));function e(e){return t.apply(this,arguments)}return e}()}]),e}();e.Draw=f}).call(this,r("0de9")["log"])}}]);